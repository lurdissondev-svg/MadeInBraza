import{d as j,r as P,c as h,A as E,a as r,n as y,b as e,e as u,t as c,i as k,F as b,s as $,f as l,o as n,u as T,B as V,y as L,C as _,D as H,E as B,G as A,H as S,I as N}from"./index-B3S1dV94.js";const q={class:"flex items-start justify-between gap-3"},z={class:"flex-1 min-w-0"},I={class:"flex items-center gap-2 mb-2"},U={key:0,class:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-gray-500/20 text-gray-400"},F={key:1,class:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-red-500/20 text-red-400"},J={class:"text-xs text-gray-500"},R={class:"font-semibold text-gray-100 mb-1"},G={key:0,class:"text-gray-400 text-sm mb-2"},O={class:"flex flex-wrap gap-3 text-xs text-gray-500"},K={class:"flex items-center gap-1"},Q={class:"flex items-center gap-1"},W={key:2,class:"mt-2 flex flex-wrap gap-1"},X={class:"ml-1 text-gray-500"},Y={class:"text-xs text-gray-500 mt-2"},Z={class:"flex flex-col items-end gap-2 flex-shrink-0"},ee=["disabled"],M=j({__name:"EventCard",props:{event:{},currentUserId:{},canDelete:{type:Boolean},isPast:{type:Boolean}},emits:["join","leave","delete"],setup(o,{emit:m}){const t=o,x=m,v=P(!1),p=h(()=>t.currentUserId?t.event.participants.some(a=>a.id===t.currentUserId):!1),g=h(()=>t.event.maxParticipants?t.event.participants.length>=t.event.maxParticipants:!1),w=h(()=>{const a=t.event.participants.length,i=t.event.maxParticipants;return i?`${a}/${i}`:`${a}`}),C=h(()=>new Date(t.event.eventDate).toLocaleDateString("pt-BR",{weekday:"short",day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit"})),D=h(()=>!t.event.requiredClasses||t.event.requiredClasses.length===0?"Todas as classes":t.event.requiredClasses.map(a=>E[a]||a).join(", "));function d(){p.value?x("leave",t.event.id):x("join",t.event.id)}function s(){x("delete",t.event.id)}return(a,i)=>(n(),r("div",{class:y(["card",{"opacity-60":o.isPast}])},[e("div",q,[e("div",z,[e("div",I,[o.isPast?(n(),r("span",U," Encerrado ")):g.value?(n(),r("span",F," Lotado ")):u("",!0),e("span",J,c(C.value),1)]),e("h4",R,c(o.event.title),1),o.event.description?(n(),r("p",G,c(o.event.description),1)):u("",!0),e("div",O,[e("span",K,[i[1]||(i[1]=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0z"})],-1)),k(" "+c(w.value)+" participantes ",1)]),e("span",Q,[i[2]||(i[2]=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})],-1)),k(" "+c(D.value),1)])]),o.event.participants.length>0?(n(),r("button",{key:1,onClick:i[0]||(i[0]=f=>v.value=!v.value),class:"mt-2 text-xs text-primary-400 hover:text-primary-300 flex items-center gap-1"},[(n(),r("svg",{class:y(["w-4 h-4 transition-transform",{"rotate-180":v.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...i[3]||(i[3]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])],2)),k(" "+c(v.value?"Ocultar":"Ver")+" participantes ",1)])):u("",!0),v.value&&o.event.participants.length>0?(n(),r("div",W,[(n(!0),r(b,null,$(o.event.participants,f=>(n(),r("span",{key:f.id,class:y(["inline-flex items-center px-2 py-0.5 rounded text-xs bg-dark-600 text-gray-300",{"bg-primary-500/20 text-primary-400":f.id===o.currentUserId}])},[k(c(f.nick)+" ",1),e("span",X,c(l(E)[f.playerClass]),1)],2))),128))])):u("",!0),e("p",Y," Por: "+c(o.event.createdBy.nick),1)]),e("div",Z,[o.canDelete?(n(),r("button",{key:0,onClick:s,class:"p-2 text-gray-500 hover:text-red-400 hover:bg-red-500/10 rounded-lg transition-colors",title:"Deletar evento"},[...i[4]||(i[4]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])])):u("",!0),o.isPast?u("",!0):(n(),r("button",{key:1,onClick:d,class:y(["btn text-sm",p.value?"btn-secondary":"btn-primary"]),disabled:!p.value&&g.value},c(p.value?"Sair":"Participar"),11,ee))])])],2))}}),te={class:"space-y-6"},se={class:"flex items-center justify-between"},ne={class:"flex items-center gap-2"},ae=["disabled"],re={key:0,class:"flex justify-center py-8"},oe={key:1,class:"card bg-red-900/20 border border-red-500/30"},ie={class:"text-red-400 text-center"},le={key:2,class:"card text-center py-8"},de={key:0},ce={class:"space-y-3"},ue={key:1},ve={class:"space-y-3"},xe=j({__name:"EventsView",setup(o){const m=T(),t=V(),x=P(!1),v=h(()=>{const d=new Date;return t.events.filter(s=>new Date(s.eventDate)>=d).sort((s,a)=>new Date(s.eventDate).getTime()-new Date(a.eventDate).getTime())}),p=h(()=>{const d=new Date;return t.events.filter(s=>new Date(s.eventDate)<d).sort((s,a)=>new Date(a.eventDate).getTime()-new Date(s.eventDate).getTime())});L(()=>{t.fetchEvents()});function g(){t.fetchEvents()}async function w(d){confirm("Tem certeza que deseja deletar este evento?")&&await t.deleteEvent(d)}async function C(d){await t.joinEvent(d)}async function D(d){await t.leaveEvent(d)}return(d,s)=>(n(),_(N,null,{default:H(()=>[e("div",te,[e("div",se,[e("div",ne,[e("button",{onClick:g,class:"p-2 rounded-lg text-gray-400 hover:text-gray-200 hover:bg-dark-600 transition-colors",disabled:l(t).loading},[(n(),r("svg",{class:y(["w-5 h-5",{"animate-spin":l(t).loading}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...s[2]||(s[2]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)])],2))],8,ae)]),l(m).isLeader?(n(),r("button",{key:0,onClick:s[0]||(s[0]=a=>x.value=!0),class:"btn btn-primary text-sm"},[...s[3]||(s[3]=[e("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),k(" Novo Evento ",-1)])])):u("",!0)]),l(t).loading&&l(t).events.length===0?(n(),r("div",re,[B(A)])):l(t).error?(n(),r("div",oe,[e("p",ie,c(l(t).error),1),e("button",{onClick:g,class:"btn btn-secondary mt-3 mx-auto block"}," Tentar novamente ")])):l(t).events.length===0?(n(),r("div",le,[...s[4]||(s[4]=[e("svg",{class:"w-12 h-12 mx-auto text-gray-500 mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1),e("p",{class:"text-gray-400"},"Nenhum evento disponível",-1)])])):(n(),r(b,{key:3},[v.value.length>0?(n(),r("div",de,[s[5]||(s[5]=e("h3",{class:"text-sm font-medium text-gray-400 uppercase tracking-wide mb-3"},"Próximos Eventos",-1)),e("div",ce,[(n(!0),r(b,null,$(v.value,a=>(n(),_(M,{key:a.id,event:a,"current-user-id":l(m).user?.id,"can-delete":l(m).isLeader,onJoin:C,onLeave:D,onDelete:w},null,8,["event","current-user-id","can-delete"]))),128))])])):u("",!0),p.value.length>0?(n(),r("div",ue,[s[6]||(s[6]=e("h3",{class:"text-sm font-medium text-gray-400 uppercase tracking-wide mb-3"},"Eventos Passados",-1)),e("div",ve,[(n(!0),r(b,null,$(p.value,a=>(n(),_(M,{key:a.id,event:a,"current-user-id":l(m).user?.id,"can-delete":l(m).isLeader,"is-past":!0,onDelete:w},null,8,["event","current-user-id","can-delete"]))),128))])])):u("",!0)],64))]),B(S,{show:x.value,"onUpdate:show":s[1]||(s[1]=a=>x.value=a)},null,8,["show"])]),_:1}))}});export{xe as default};
