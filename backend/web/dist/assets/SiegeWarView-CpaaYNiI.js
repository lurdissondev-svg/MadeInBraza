import{q as R,s as q,r as k,d as F,a as r,o as a,b as e,t as d,n as E,x as j,S as A,I as u,c as V,e as S,F as $,m as D,f as M,J as B,g as l,v as Y,E as L,G as K,P as z,y as P,i as W,z as I,u as G,C as J,A as X}from"./index-CZitzd5D.js";import{_ as Z}from"./MainLayout.vue_vue_type_script_setup_true_lang-BGXrfI_D.js";import{_ as O}from"./LoadingSpinner.vue_vue_type_script_setup_true_lang-CUL6qR6H.js";const w={async getCurrentSiegeWar(){return(await R.get("/siege-war/current")).data},async createSiegeWar(){return(await R.post("/siege-war")).data.siegeWar},async submitResponse(s,x){return(await R.post(`/siege-war/${s}/respond`,x)).data.response},async getResponses(s){return(await R.get(`/siege-war/${s}/responses`)).data},async getAvailableShares(s){return(await R.get(`/siege-war/${s}/available-shares`)).data.availableShares},async closeSiegeWar(s){return(await R.post(`/siege-war/${s}/close`)).data.siegeWar},async getHistory(){return(await R.get("/siege-war/history")).data.siegeWars}},ee=q("siegeWar",()=>{const s=k(null),x=k(null),o=k([]),g=k([]),f=k([]),y=k(null),C=k([]),b=k(!1),T=k(!1),n=k(!1),t=k(null);async function m(){b.value=!0,t.value=null;try{const p=await w.getCurrentSiegeWar();return s.value=p.siegeWar,x.value=p.userResponse,!0}catch(p){return t.value=p instanceof Error?p.message:"Erro ao carregar Siege War",!1}finally{b.value=!1}}async function v(){b.value=!0,t.value=null;try{return s.value=await w.createSiegeWar(),!0}catch(p){return t.value=p instanceof Error?p.message:"Erro ao criar Siege War",!1}finally{b.value=!1}}async function N(p){if(!s.value)return!1;T.value=!0,t.value=null;try{return x.value=await w.submitResponse(s.value.id,p),!0}catch(U){return t.value=U instanceof Error?U.message:"Erro ao enviar resposta",!1}finally{T.value=!1}}async function H(){if(!s.value)return!1;b.value=!0,t.value=null;try{const p=await w.getResponses(s.value.id);return o.value=p.responses,g.value=p.notResponded,f.value=p.availableShares,y.value=p.summary,!0}catch(p){return t.value=p instanceof Error?p.message:"Erro ao carregar respostas",!1}finally{b.value=!1}}async function h(){if(!s.value)return!1;try{return f.value=await w.getAvailableShares(s.value.id),!0}catch(p){return t.value=p instanceof Error?p.message:"Erro ao carregar contas disponíveis",!1}}async function i(){if(!s.value)return!1;b.value=!0,t.value=null;try{return s.value=await w.closeSiegeWar(s.value.id),!0}catch(p){return t.value=p instanceof Error?p.message:"Erro ao fechar Siege War",!1}finally{b.value=!1}}async function c(){n.value=!0,t.value=null;try{return C.value=await w.getHistory(),!0}catch(p){return t.value=p instanceof Error?p.message:"Erro ao carregar histórico",!1}finally{n.value=!1}}function _(){t.value=null}return{siegeWar:s,userResponse:x,responses:o,notResponded:g,availableShares:f,summary:y,history:C,loading:b,submitting:T,loadingHistory:n,error:t,fetchCurrentSiegeWar:m,createSiegeWar:v,submitResponse:N,fetchResponses:H,fetchAvailableShares:h,closeSiegeWar:i,fetchHistory:c,clearError:_}}),te={class:"bg-primary-600 rounded-xl p-6 mb-6"},se={class:"text-2xl font-bold text-white mb-3"},ae=F({__name:"SiegeWarHeader",props:{siegeWar:{}},setup(s){function x(o){try{const g=new Date(o),f=g.getDay(),y=f===0?0:f;g.setDate(g.getDate()-y);const C=g.toLocaleDateString("pt-BR",{weekday:"long"}),b=g.toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit"});return`${C.charAt(0).toUpperCase()+C.slice(1)}, ${b}`}catch{return o}}return(o,g)=>(a(),r("div",te,[e("h2",se,d(x(s.siegeWar.weekEnd)),1),e("span",{class:E(["inline-flex items-center px-3 py-1 rounded-full text-sm font-medium",s.siegeWar.isActive?"bg-white text-primary-600":"bg-red-500 text-white"])},d(s.siegeWar.isActive?"ATIVO":"FECHADO"),3)]))}}),re={class:"space-y-6"},oe={class:"card"},ne={class:"space-y-2"},le=["value","disabled"],ie={class:"text-gray-200"},de={class:"card"},ue={class:"space-y-2"},ce=["value","disabled"],me={class:"text-gray-200 block"},pe={class:"text-sm text-gray-400"},ye={key:0,class:"card"},ge={class:"space-y-4"},ve=["disabled"],xe=["disabled"],be={class:"flex flex-wrap gap-2"},fe=["onClick","disabled"],he={key:1,class:"card"},ke={key:0,class:"text-gray-400 text-sm"},Ce={key:1,class:"space-y-2 mb-6"},Se=["value","disabled"],Ae={class:"text-gray-200"},Ee={key:0,class:"text-sm text-gray-400 ml-2"},$e={class:"flex flex-wrap gap-2"},Te=["onClick","disabled"],_e={key:2,class:"card bg-green-900/20 border border-green-500/30"},De={class:"flex items-center gap-3"},Re={class:"font-medium text-green-400"},we={key:0,class:"text-sm text-green-300/70"},Ie=["disabled"],We=F({__name:"ResponseForm",props:{userResponse:{},availableShares:{},isActive:{type:Boolean},submitting:{type:Boolean}},emits:["submit","loadShares"],setup(s,{emit:x}){const o=s,g=x,f=k(null),y=k(null),C=k(""),b=k(""),T=k(null),n=k(null),t=k(null);j(()=>o.userResponse,h=>{h&&(f.value=h.tag,y.value=h.responseType,h.responseType===u.SHARED&&(C.value=h.gameId||"",T.value=h.sharedClass),h.responseType===u.PILOT&&(t.value=h.preferredClass))},{immediate:!0}),j(()=>y.value,h=>{h===u.PILOT&&g("loadShares")});const m=[{value:A.ATTACK,label:"ATAQUE"},{value:A.DEFENSE,label:"DEFESA"},{value:A.ACADEMY,label:"ACADEMY"}],v=[{value:u.CONFIRMED,label:"Estarei lá com certeza!",description:"Vou participar com minha conta"},{value:u.SHARED,label:"Vou deixar Shared!",description:"Vou disponibilizar minha conta para outro pilotar"},{value:u.PILOT,label:"Vou de Piloto!",description:"Vou pilotar a conta de outro membro"}],N=V(()=>!f.value||!y.value?!1:y.value===u.SHARED?C.value.trim()&&b.value.trim()&&T.value:y.value===u.PILOT?n.value&&t.value:!0);function H(){if(!N.value)return;const h={responseType:y.value,tag:f.value};y.value===u.SHARED&&(h.gameId=C.value.trim(),h.password=b.value.trim(),h.sharedClass=T.value),y.value===u.PILOT&&(h.pilotingForId=n.value?.userId,h.preferredClass=t.value),g("submit",h)}return(h,i)=>(a(),r("div",re,[e("div",oe,[i[5]||(i[5]=e("h3",{class:"font-medium text-gray-100 mb-2"},"TAG *",-1)),i[6]||(i[6]=e("p",{class:"text-sm text-gray-400 mb-4"},"Selecione seu time",-1)),e("div",ne,[(a(),r($,null,D(m,c=>e("label",{key:c.value,class:E(["flex items-center gap-3 p-3 rounded-lg cursor-pointer transition-colors",f.value===c.value?"bg-primary-500/20 border border-primary-500":"bg-dark-600 border border-transparent hover:bg-dark-500"])},[M(e("input",{type:"radio",value:c.value,"onUpdate:modelValue":i[0]||(i[0]=_=>f.value=_),class:"w-4 h-4 text-primary-500 border-gray-600 focus:ring-primary-500 focus:ring-offset-dark-700",disabled:!s.isActive},null,8,le),[[B,f.value]]),e("span",ie,d(c.label),1)],2)),64))])]),e("div",de,[i[7]||(i[7]=e("h3",{class:"font-medium text-gray-100 mb-2"},"Confirmado ou Shared? *",-1)),i[8]||(i[8]=e("p",{class:"text-sm text-gray-400 mb-4"},"Como você vai participar?",-1)),e("div",ue,[(a(),r($,null,D(v,c=>e("label",{key:c.value,class:E(["flex items-start gap-3 p-3 rounded-lg cursor-pointer transition-colors",y.value===c.value?"bg-primary-500/20 border border-primary-500":"bg-dark-600 border border-transparent hover:bg-dark-500"])},[M(e("input",{type:"radio",value:c.value,"onUpdate:modelValue":i[1]||(i[1]=_=>y.value=_),class:"w-4 h-4 mt-1 text-primary-500 border-gray-600 focus:ring-primary-500 focus:ring-offset-dark-700",disabled:!s.isActive},null,8,ce),[[B,y.value]]),e("div",null,[e("span",me,d(c.label),1),e("span",pe,d(c.description),1)])],2)),64))])]),y.value===l(u).SHARED?(a(),r("div",ye,[i[12]||(i[12]=e("h3",{class:"font-medium text-gray-100 mb-2"},"Dados da Conta Compartilhada",-1)),i[13]||(i[13]=e("p",{class:"text-sm text-gray-400 mb-4"},"Informe os dados para outro membro pilotar",-1)),e("div",ge,[e("div",null,[i[9]||(i[9]=e("label",{for:"gameId",class:"label"},"ID do Jogo *",-1)),M(e("input",{id:"gameId","onUpdate:modelValue":i[2]||(i[2]=c=>C.value=c),type:"text",class:"input",placeholder:"Digite o ID da conta",disabled:!s.isActive},null,8,ve),[[Y,C.value]])]),e("div",null,[i[10]||(i[10]=e("label",{for:"password",class:"label"},"Senha *",-1)),M(e("input",{id:"password","onUpdate:modelValue":i[3]||(i[3]=c=>b.value=c),type:"text",class:"input",placeholder:"Digite a senha",disabled:!s.isActive},null,8,xe),[[Y,b.value]])]),e("div",null,[i[11]||(i[11]=e("label",{class:"label mb-2"},"Classe da conta *",-1)),e("div",be,[(a(!0),r($,null,D(Object.values(l(K)),c=>(a(),r("button",{key:c,type:"button",onClick:_=>T.value=c,class:E(["px-3 py-1.5 rounded-lg text-sm transition-colors",T.value===c?"bg-primary-500 text-white":"bg-dark-600 text-gray-300 hover:bg-dark-500"]),disabled:!s.isActive},d(l(L)[c]),11,fe))),128))])])])])):S("",!0),y.value===l(u).PILOT?(a(),r("div",he,[i[14]||(i[14]=e("h3",{class:"font-medium text-gray-100 mb-2"},"Selecionar Conta para Pilotar",-1)),i[15]||(i[15]=e("p",{class:"text-sm text-gray-400 mb-4"},"Escolha uma conta disponível",-1)),s.availableShares.length===0?(a(),r("div",ke," Nenhuma conta disponível para pilotagem no momento ")):(a(),r("div",Ce,[(a(!0),r($,null,D(s.availableShares,c=>(a(),r("label",{key:c.userId,class:E(["flex items-center gap-3 p-3 rounded-lg cursor-pointer transition-colors",n.value?.userId===c.userId?"bg-primary-500/20 border border-primary-500":"bg-dark-600 border border-transparent hover:bg-dark-500"])},[M(e("input",{type:"radio",value:c,"onUpdate:modelValue":i[4]||(i[4]=_=>n.value=_),class:"w-4 h-4 text-primary-500 border-gray-600 focus:ring-primary-500 focus:ring-offset-dark-700",disabled:!s.isActive},null,8,Se),[[B,n.value]]),e("div",null,[e("span",Ae,d(c.nick),1),c.sharedClass?(a(),r("span",Ee," ("+d(l(z)[c.sharedClass])+") ",1)):S("",!0)])],2))),128))])),i[16]||(i[16]=e("h4",{class:"font-medium text-gray-100 mb-2"},"Classe Preferida *",-1)),i[17]||(i[17]=e("p",{class:"text-sm text-gray-400 mb-4"},"Qual classe você prefere pilotar?",-1)),e("div",$e,[(a(!0),r($,null,D(Object.values(l(K)),c=>(a(),r("button",{key:c,type:"button",onClick:_=>t.value=c,class:E(["px-3 py-1.5 rounded-lg text-sm transition-colors",t.value===c?"bg-primary-500 text-white":"bg-dark-600 text-gray-300 hover:bg-dark-500"]),disabled:!s.isActive},d(l(L)[c]),11,Te))),128))])])):S("",!0),s.userResponse?(a(),r("div",_e,[e("div",De,[i[19]||(i[19]=e("svg",{class:"w-5 h-5 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1)),e("div",null,[i[18]||(i[18]=e("p",{class:"text-sm text-green-300"},"Sua resposta atual:",-1)),e("p",Re,d(s.userResponse.responseType==="CONFIRMED"?"Confirmado":s.userResponse.responseType==="SHARED"?"Compartilhando conta":s.userResponse.responseType==="PILOT"?`Pilotando: ${s.userResponse.pilotingFor?.nick||"outro membro"}`:"Ausente"),1),s.userResponse.tag?(a(),r("p",we," Time: "+d(s.userResponse.tag==="ATTACK"?"ATAQUE":s.userResponse.tag==="DEFENSE"?"DEFESA":"ACADEMY"),1)):S("",!0)])])])):S("",!0),e("button",{onClick:H,class:"btn btn-primary w-full",disabled:!N.value||s.submitting||!s.isActive},[s.submitting?(a(),P(O,{key:0,size:"sm",class:"mr-2"})):S("",!0),W(" "+d(s.submitting?"Enviando...":"ENVIAR"),1)],8,Ie)]))}}),Ne={class:"card"},Me={class:"flex items-center justify-between mb-6"},Oe={key:0,class:"grid grid-cols-3 sm:grid-cols-6 gap-4 mb-6"},Le={class:"text-center"},Fe={class:"text-2xl font-bold text-gray-100"},Pe={class:"text-center"},He={class:"text-2xl font-bold text-primary-400"},Be={class:"text-center"},je={class:"text-2xl font-bold text-primary-400"},Ve={class:"text-center"},ze={class:"text-2xl font-bold text-purple-400"},Ue={class:"text-center"},Ye={class:"text-2xl font-bold text-cyan-400"},Ke={class:"text-center"},Qe={class:"text-2xl font-bold text-red-400"},qe={key:1,class:"mb-6"},Ge={class:"text-sm font-medium text-red-400 mb-2"},Je={class:"text-sm text-gray-400"},Xe={key:2},Ze={class:"space-y-3"},et={class:"flex items-center justify-between mb-2"},tt={class:"flex items-center gap-2"},st={key:0,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},at={key:1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"},rt={key:2,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"},ot={key:3,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"},nt={class:"font-medium text-gray-100"},lt={class:"text-sm text-gray-400"},it={class:"text-sm text-gray-400"},dt={key:0},ut=F({__name:"LeaderPanel",props:{summary:{},responses:{},notResponded:{},isActive:{type:Boolean}},emits:["close"],setup(s,{emit:x}){const o=x,g={[A.ATTACK]:"bg-red-500",[A.DEFENSE]:"bg-blue-500",[A.ACADEMY]:"bg-green-500"},f={[A.ATTACK]:"ATAQUE",[A.DEFENSE]:"DEFESA",[A.ACADEMY]:"ACADEMY"},y={[u.CONFIRMED]:"text-primary-400",[u.SHARED]:"text-purple-400",[u.PILOT]:"text-cyan-400",[u.ABSENT]:"text-red-400"},C={[u.CONFIRMED]:"CONFIRMADO",[u.SHARED]:"SHARED",[u.PILOT]:"PILOTO",[u.ABSENT]:"AUSENTE"};function b(){confirm("Tem certeza que deseja fechar este Siege War?")&&o("close")}return(T,n)=>(a(),r("div",Ne,[e("div",Me,[n[1]||(n[1]=e("h3",{class:"text-lg font-semibold text-gray-100"},"Painel do Líder",-1)),s.isActive?(a(),r("button",{key:0,onClick:b,class:"flex items-center gap-2 px-3 py-1.5 text-sm text-red-400 hover:text-red-300 hover:bg-red-500/10 rounded-lg transition-colors"},[...n[0]||(n[0]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})],-1),W(" Fechar SW ",-1)])])):S("",!0)]),s.summary?(a(),r("div",Oe,[e("div",Le,[e("p",Fe,d(s.summary.total),1),n[2]||(n[2]=e("p",{class:"text-xs text-gray-400"},"Total",-1))]),e("div",Pe,[e("p",He,d(s.summary.responded),1),n[3]||(n[3]=e("p",{class:"text-xs text-gray-400"},"Resp.",-1))]),e("div",Be,[e("p",je,d(s.summary.confirmed),1),n[4]||(n[4]=e("p",{class:"text-xs text-gray-400"},"Conf.",-1))]),e("div",Ve,[e("p",ze,d(s.summary.shared),1),n[5]||(n[5]=e("p",{class:"text-xs text-gray-400"},"Comp.",-1))]),e("div",Ue,[e("p",Ye,d(s.summary.pilots),1),n[6]||(n[6]=e("p",{class:"text-xs text-gray-400"},"Pilot",-1))]),e("div",Ke,[e("p",Qe,d(s.summary.absent),1),n[7]||(n[7]=e("p",{class:"text-xs text-gray-400"},"Aus.",-1))])])):S("",!0),s.notResponded.length>0?(a(),r("div",qe,[e("p",Ge,"Não responderam ("+d(s.notResponded.length)+"):",1),e("p",Je,d(s.notResponded.map(t=>t.nick).join(", ")),1)])):S("",!0),s.responses.length>0?(a(),r("div",Xe,[n[10]||(n[10]=e("p",{class:"text-sm font-medium text-gray-300 mb-3"},"Respostas:",-1)),e("div",Ze,[(a(!0),r($,null,D(s.responses,t=>(a(),r("div",{key:t.id,class:E(["p-3 rounded-lg border",{"bg-primary-500/10 border-primary-500/30":t.responseType===l(u).CONFIRMED,"bg-purple-500/10 border-purple-500/30":t.responseType===l(u).SHARED,"bg-cyan-500/10 border-cyan-500/30":t.responseType===l(u).PILOT,"bg-red-500/10 border-red-500/30":t.responseType===l(u).ABSENT}])},[e("div",et,[e("div",tt,[(a(),r("svg",{class:E(["w-4 h-4",y[t.responseType]]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t.responseType===l(u).CONFIRMED?(a(),r("path",st)):t.responseType===l(u).SHARED?(a(),r("path",at)):t.responseType===l(u).PILOT?(a(),r("path",rt)):(a(),r("path",ot))],2)),e("span",nt,d(t.user.nick),1),e("span",lt,"("+d(l(L)[t.user.playerClass])+")",1)]),t.tag?(a(),r("span",{key:0,class:E(["px-2 py-0.5 rounded text-xs text-white",g[t.tag]])},d(f[t.tag]),3)):S("",!0)]),e("p",{class:E(["text-sm font-medium mb-1",y[t.responseType]])},d(C[t.responseType]),3),e("div",it,[t.responseType===l(u).CONFIRMED?(a(),r($,{key:0},[W(" Vai participar com sua própria conta ")],64)):t.responseType===l(u).SHARED?(a(),r($,{key:1},[n[8]||(n[8]=e("p",null,"Deixando conta para pilotagem:",-1)),e("p",null,"ID: "+d(t.gameId||"-"),1),e("p",null,"Senha: "+d(t.password||"***"),1),e("p",null,"Classe: "+d(t.sharedClass?l(z)[t.sharedClass]:"-"),1)],64)):t.responseType===l(u).PILOT?(a(),r($,{key:2},[n[9]||(n[9]=e("p",null,"Vai pilotar conta de outro membro:",-1)),e("p",null,[W(" Pilotando: "+d(t.pilotingFor?.nick||"-")+" ",1),t.pilotingFor?.playerClass?(a(),r("span",dt,"("+d(l(L)[t.pilotingFor.playerClass])+")",1)):S("",!0)]),e("p",null,"Classe preferida: "+d(t.preferredClass?l(z)[t.preferredClass]:"-"),1)],64)):(a(),r($,{key:3},[W(" Não vai participar desta SW ")],64))])],2))),128))])])):S("",!0)]))}}),ct={key:0,class:"flex justify-center py-12"},mt={key:1,class:"text-center py-12"},pt={key:2,class:"space-y-4"},yt=["onClick"],gt={class:"flex items-center justify-between mb-4"},vt={class:"font-semibold text-gray-100"},xt={class:"flex flex-wrap gap-3"},bt={class:"text-center"},ft={class:"text-lg font-bold text-primary-400"},ht={class:"text-center"},kt={class:"text-lg font-bold text-primary-400"},Ct={class:"text-center"},St={class:"text-lg font-bold text-purple-400"},At={class:"text-center"},Et={class:"text-lg font-bold text-cyan-400"},$t={class:"text-center"},Tt={class:"text-lg font-bold text-red-400"},_t={key:0,class:"mt-4 pt-4 border-t border-dark-600"},Dt={key:0,class:"text-sm text-gray-400"},Rt={key:1,class:"space-y-2"},wt={class:"flex items-center gap-2"},It=["d"],Wt={class:"text-gray-200"},Nt={class:"text-sm text-gray-500"},Mt={class:"flex items-center gap-2"},Q=F({__name:"HistoryTab",props:{history:{},loading:{type:Boolean}},setup(s){const x=k(new Set);function o(n){x.value.has(n)?x.value.delete(n):x.value.add(n)}function g(n){try{const t=new Date(n),m=t.getDay(),v=m===0?0:m;return t.setDate(t.getDate()-v),`Domingo, ${t.toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric"})}`}catch{return n}}const f={[A.ATTACK]:"bg-red-500",[A.DEFENSE]:"bg-blue-500",[A.ACADEMY]:"bg-green-500"},y={[A.ATTACK]:"ATAQUE",[A.DEFENSE]:"DEFESA",[A.ACADEMY]:"ACADEMY"},C={[u.CONFIRMED]:"bg-primary-500/20 text-primary-400",[u.SHARED]:"bg-purple-500/20 text-purple-400",[u.PILOT]:"bg-cyan-500/20 text-cyan-400",[u.ABSENT]:"bg-red-500/20 text-red-400"},b={[u.CONFIRMED]:"CONFIRMADO",[u.SHARED]:"SHARED",[u.PILOT]:"PILOTO",[u.ABSENT]:"AUSENTE"};function T(n){switch(n){case u.CONFIRMED:return"M5 13l4 4L19 7";case u.SHARED:return"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z";case u.PILOT:return"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z";case u.ABSENT:return"M6 18L18 6M6 6l12 12"}}return(n,t)=>(a(),r("div",null,[s.loading?(a(),r("div",ct,[I(O)])):s.history.length===0?(a(),r("div",mt,[...t[0]||(t[0]=[e("p",{class:"text-gray-400"},"Nenhum histórico disponível",-1)])])):(a(),r("div",pt,[(a(!0),r($,null,D(s.history,m=>(a(),r("div",{key:m.id,class:"card"},[e("button",{onClick:v=>o(m.id),class:"w-full text-left"},[e("div",gt,[e("h4",vt,d(g(m.weekEnd)),1),(a(),r("svg",{class:E(["w-5 h-5 text-gray-400 transition-transform",{"rotate-180":x.value.has(m.id)}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...t[1]||(t[1]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])],2))]),e("div",xt,[e("div",bt,[e("span",ft,d(m.summary.responded),1),t[2]||(t[2]=e("span",{class:"text-xs text-gray-400 ml-1"},"Resp.",-1))]),e("div",ht,[e("span",kt,d(m.summary.confirmed),1),t[3]||(t[3]=e("span",{class:"text-xs text-gray-400 ml-1"},"Conf.",-1))]),e("div",Ct,[e("span",St,d(m.summary.shared),1),t[4]||(t[4]=e("span",{class:"text-xs text-gray-400 ml-1"},"Comp.",-1))]),e("div",At,[e("span",Et,d(m.summary.pilots),1),t[5]||(t[5]=e("span",{class:"text-xs text-gray-400 ml-1"},"Pilot",-1))]),e("div",$t,[e("span",Tt,d(m.summary.absent),1),t[6]||(t[6]=e("span",{class:"text-xs text-gray-400 ml-1"},"Aus.",-1))])])],8,yt),x.value.has(m.id)?(a(),r("div",_t,[m.responses.length===0?(a(),r("div",Dt," Nenhuma resposta registrada ")):(a(),r("div",Rt,[(a(!0),r($,null,D(m.responses,v=>(a(),r("div",{key:v.id,class:"flex items-center justify-between py-2"},[e("div",wt,[(a(),r("svg",{class:E(["w-4 h-4",C[v.responseType].split(" ")[1]]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:T(v.responseType)},null,8,It)],2)),e("span",Wt,d(v.user.nick),1),e("span",Nt,"("+d(l(L)[v.user.playerClass])+")",1)]),e("div",Mt,[v.tag?(a(),r("span",{key:0,class:E(["px-2 py-0.5 rounded text-xs text-white",f[v.tag]])},d(y[v.tag]),3)):S("",!0),e("span",{class:E(["px-2 py-0.5 rounded text-xs font-medium",C[v.responseType]])},d(b[v.responseType]),3)])]))),128))]))])):S("",!0)]))),128))]))]))}}),Ot={class:"space-y-4"},Lt={key:0,class:"flex justify-center py-12"},Ft={key:1,class:"card bg-red-900/20 border border-red-500/30"},Pt={class:"text-red-400"},Ht={class:"card text-center py-8"},Bt=["disabled"],jt={class:"mt-6"},Vt={class:"flex border-b border-dark-600"},zt=["onClick"],Ut={key:0,class:"absolute bottom-0 left-0 right-0 h-0.5 bg-primary-500"},Yt={class:"mt-4"},Kt={key:0},Qt={key:1},qt={key:0,class:"flex justify-center py-12"},Gt={key:2},es=F({__name:"SiegeWarView",setup(s){const x=G(),o=ee(),g=k("response"),f=V(()=>x.user?.role==="LEADER"),y=V(()=>{const t=[{id:"response",label:"Minha Resposta"},{id:"history",label:"Histórico"}];return f.value&&t.splice(1,0,{id:"responses",label:"Respostas"}),t});J(async()=>{await o.fetchCurrentSiegeWar(),o.fetchHistory()}),j(g,t=>{t==="responses"&&o.siegeWar&&o.fetchResponses()});async function C(){await o.createSiegeWar()}async function b(t){await o.submitResponse(t)}async function T(){await o.fetchAvailableShares()}async function n(){await o.closeSiegeWar()}return(t,m)=>(a(),P(Z,null,{default:X(()=>[e("div",Ot,[l(o).loading&&!l(o).siegeWar?(a(),r("div",Lt,[I(O)])):l(o).error?(a(),r("div",Ft,[e("p",Pt,d(l(o).error),1),e("button",{onClick:m[0]||(m[0]=v=>l(o).fetchCurrentSiegeWar()),class:"mt-4 btn btn-primary"}," Tentar novamente ")])):l(o).siegeWar?(a(),r($,{key:3},[I(ae,{"siege-war":l(o).siegeWar},null,8,["siege-war"]),e("div",Vt,[(a(!0),r($,null,D(y.value,v=>(a(),r("button",{key:v.id,onClick:N=>g.value=v.id,class:E(["flex-1 py-3 text-sm font-medium transition-colors relative",g.value===v.id?"text-primary-400":"text-gray-400 hover:text-gray-200"])},[W(d(v.label)+" ",1),g.value===v.id?(a(),r("div",Ut)):S("",!0)],10,zt))),128))]),e("div",Yt,[g.value==="response"?(a(),r("div",Kt,[I(We,{"user-response":l(o).userResponse,"available-shares":l(o).availableShares,"is-active":l(o).siegeWar.isActive,submitting:l(o).submitting,onSubmit:b,onLoadShares:T},null,8,["user-response","available-shares","is-active","submitting"])])):g.value==="responses"?(a(),r("div",Qt,[l(o).loading?(a(),r("div",qt,[I(O)])):(a(),P(ut,{key:1,summary:l(o).summary,responses:l(o).responses,"not-responded":l(o).notResponded,"is-active":l(o).siegeWar.isActive,onClose:n},null,8,["summary","responses","not-responded","is-active"]))])):g.value==="history"?(a(),r("div",Gt,[I(Q,{history:l(o).history,loading:l(o).loadingHistory},null,8,["history","loading"])])):S("",!0)])],64)):(a(),r($,{key:2},[e("div",Ht,[m[2]||(m[2]=e("svg",{class:"w-16 h-16 mx-auto text-gray-500 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})],-1)),m[3]||(m[3]=e("p",{class:"text-gray-400 mb-4"},"Nenhum Siege War ativo no momento",-1)),f.value?(a(),r("button",{key:0,onClick:C,disabled:l(o).loading,class:"btn btn-primary"},[l(o).loading?(a(),P(O,{key:0,size:"sm",class:"mr-2"})):S("",!0),m[1]||(m[1]=W(" Criar Novo Siege War ",-1))],8,Bt)):S("",!0)]),e("div",jt,[m[4]||(m[4]=e("h3",{class:"text-lg font-semibold text-gray-100 mb-4"},"Histórico",-1)),I(Q,{history:l(o).history,loading:l(o).loadingHistory},null,8,["history","loading"])])],64))])]),_:1}))}});export{es as default};
