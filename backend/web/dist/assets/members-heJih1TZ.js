import{x as o,y as J,r as t,u as K,c as i,R as u}from"./index-BCVEqFNE.js";const l={async getMembers(){return(await o.get("/users/members")).data.members},async getMemberProfile(a){return(await o.get(`/users/${a}/profile`)).data.user},async getPendingUsers(){return(await o.get("/users/pending")).data.users},async approveUser(a){await o.post(`/users/${a}/approve`)},async rejectUser(a){await o.post(`/users/${a}/reject`)},async getBannedUsers(){return(await o.get("/users/banned")).data.users},async banMember(a){await o.post(`/users/${a}/ban`)},async unbanUser(a){await o.post(`/users/${a}/unban`)},async promoteMember(a){await o.post(`/users/${a}/promote`)},async demoteMember(a){await o.post(`/users/${a}/demote`)}},O=J("members",()=>{const a=t([]),c=t([]),m=t([]),v=t(null),f=t(!1),p=t(!1),g=t(!1),d=t(!1),n=t(null),b=t(null),y=t(null),E=t(null),M=t(null),h=t(null),w=t(null),U=K(),R=i(()=>U.user?.role===u.LEADER),A=i(()=>U.user?.id),L=i(()=>[...a.value].sort((r,e)=>r.role===u.LEADER&&e.role!==u.LEADER?-1:r.role!==u.LEADER&&e.role===u.LEADER?1:r.nick.localeCompare(e.nick))),P=i(()=>a.value.filter(r=>r.role===u.LEADER).length),j=i(()=>a.value.filter(r=>r.role===u.MEMBER).length);async function D(){f.value=!0,n.value=null;try{a.value=await l.getMembers()}catch(r){const e=r;n.value=e.response?.data?.message||"Erro ao carregar membros",console.error("Error fetching members:",r)}finally{f.value=!1}}async function $(r){d.value=!0,n.value=null;try{v.value=await l.getMemberProfile(r)}catch(e){const s=e;n.value=s.response?.data?.message||"Erro ao carregar perfil",console.error("Error fetching member profile:",e)}finally{d.value=!1}}async function B(){p.value=!0,n.value=null;try{c.value=await l.getPendingUsers()}catch(r){const e=r;n.value=e.response?.data?.message||"Erro ao carregar pendentes",console.error("Error fetching pending users:",r)}finally{p.value=!1}}async function S(){g.value=!0,n.value=null;try{m.value=await l.getBannedUsers()}catch(r){const e=r;n.value=e.response?.data?.message||"Erro ao carregar banidos",console.error("Error fetching banned users:",r)}finally{g.value=!1}}async function C(r){h.value=r,n.value=null;try{return await l.approveUser(r),c.value=c.value.filter(e=>e.id!==r),!0}catch(e){const s=e;return n.value=s.response?.data?.message||"Erro ao aprovar usuário",console.error("Error approving user:",e),!1}finally{h.value=null}}async function x(r){w.value=r,n.value=null;try{return await l.rejectUser(r),c.value=c.value.filter(e=>e.id!==r),!0}catch(e){const s=e;return n.value=s.response?.data?.message||"Erro ao rejeitar usuário",console.error("Error rejecting user:",e),!1}finally{w.value=null}}async function k(r){b.value=r,n.value=null;try{await l.promoteMember(r);const e=a.value.find(s=>s.id===r);return e&&(e.role=u.LEADER),!0}catch(e){const s=e;return n.value=s.response?.data?.message||"Erro ao promover membro",console.error("Error promoting member:",e),!1}finally{b.value=null}}async function q(r){y.value=r,n.value=null;try{await l.demoteMember(r);const e=a.value.find(s=>s.id===r);return e&&(e.role=u.MEMBER),!0}catch(e){const s=e;return n.value=s.response?.data?.message||"Erro ao rebaixar membro",console.error("Error demoting member:",e),!1}finally{y.value=null}}async function z(r){E.value=r,n.value=null;try{return await l.banMember(r),a.value=a.value.filter(e=>e.id!==r),!0}catch(e){const s=e;return n.value=s.response?.data?.message||"Erro ao banir membro",console.error("Error banning member:",e),!1}finally{E.value=null}}async function F(r){M.value=r,n.value=null;try{return await l.unbanUser(r),m.value=m.value.filter(e=>e.id!==r),!0}catch(e){const s=e;return n.value=s.response?.data?.message||"Erro ao desbanir usuário",console.error("Error unbanning user:",e),!1}finally{M.value=null}}function G(){n.value=null}function H(){v.value=null}return{members:a,pendingUsers:c,bannedUsers:m,selectedMember:v,loading:f,loadingPending:p,loadingBanned:g,loadingProfile:d,error:n,promotingId:b,demotingId:y,banningId:E,unbanningId:M,approvingId:h,rejectingId:w,isLeader:R,currentUserId:A,sortedMembers:L,leaderCount:P,memberCount:j,fetchMembers:D,fetchMemberProfile:$,fetchPendingUsers:B,fetchBannedUsers:S,approveUser:C,rejectUser:x,promoteMember:k,demoteMember:q,banMember:z,unbanUser:F,clearError:G,clearSelectedMember:H}});export{O as u};
