import{q as P,s as R,r as g,u as E,d as z,G as I,P as N,C as D,a as c,o as i,b as e,w as H,e as f,g as r,t as m,f as w,v as S,l as O,F as _,m as T,y as h,c as V,n as A,x as F,A as M,z as $,R as G,i as k,D as K,j as J}from"./index-CZitzd5D.js";import{_ as Q}from"./MainLayout.vue_vue_type_script_setup_true_lang-BGXrfI_D.js";import{_ as L}from"./LoadingSpinner.vue_vue_type_script_setup_true_lang-CUL6qR6H.js";import{_ as q}from"./_plugin-vue_export-helper-DlAUqK2U.js";const j={async getProfile(){return(await P.get("/profile")).data.profile},async updateProfile(y){return(await P.put("/profile",y)).data.profile},async changePassword(y,v){const o={currentPassword:y,newPassword:v};await P.put("/auth/change-password",o)}},B=R("profile",()=>{const y=g(null),v=g(!1),o=g(!1),l=g(!1),n=g(null),d=g(null);async function p(){v.value=!0,n.value=null;try{y.value=await j.getProfile()}catch(t){const u=t;n.value=u.response?.data?.message||"Erro ao carregar perfil",console.error("Error fetching profile:",t)}finally{v.value=!1}}async function x(t){o.value=!0,n.value=null;try{y.value=await j.updateProfile(t);const u=E();return u.user&&(t.nick&&(u.user.nick=t.nick),t.playerClass&&(u.user.playerClass=t.playerClass)),d.value="Perfil atualizado com sucesso!",!0}catch(u){const C=u;return n.value=C.response?.data?.message||"Erro ao atualizar perfil",console.error("Error updating profile:",u),!1}finally{o.value=!1}}async function b(t,u){l.value=!0,n.value=null;try{return await j.changePassword(t,u),d.value="Senha alterada com sucesso!",!0}catch(C){const U=C;return n.value=U.response?.data?.message||"Erro ao alterar senha",console.error("Error changing password:",C),!1}finally{l.value=!1}}function s(){n.value=null}function a(){d.value=null}return{profile:y,loading:v,updating:o,changingPassword:l,error:n,successMessage:d,fetchProfile:p,updateProfile:x,changePassword:b,clearError:s,clearSuccessMessage:a}}),W={class:"fixed inset-x-0 bottom-0 z-50 animate-slide-up"},X={class:"bg-dark-700 rounded-t-2xl max-h-[80vh] overflow-hidden flex flex-col"},Y={class:"flex items-center justify-between p-4 border-b border-dark-600"},Z={key:0,class:"bg-red-900/20 border border-red-500/30 rounded-lg p-3"},ee={class:"text-red-400 text-sm"},te=["value"],se=["disabled"],re=z({__name:"EditProfileSheet",emits:["close"],setup(y,{emit:v}){const o=B(),l=E(),n=v,d=g(""),p=g(I.ASSASSIN),x=Object.entries(N).map(([s,a])=>({value:s,label:a}));D(()=>{l.user&&(d.value=l.user.nick,p.value=l.user.playerClass)});async function b(){await o.updateProfile({nick:d.value,playerClass:p.value})&&n("close")}return(s,a)=>(i(),c(_,null,[e("div",{class:"fixed inset-0 bg-black/50 z-40",onClick:a[0]||(a[0]=t=>n("close"))}),e("div",W,[e("div",X,[e("div",Y,[a[5]||(a[5]=e("h3",{class:"text-lg font-semibold text-gray-100"},"Editar Perfil",-1)),e("button",{onClick:a[1]||(a[1]=t=>n("close")),class:"p-2 hover:bg-dark-600 rounded-lg transition-colors"},[...a[4]||(a[4]=[e("svg",{class:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("form",{onSubmit:H(b,["prevent"]),class:"flex-1 overflow-y-auto p-4 space-y-4"},[r(o).error?(i(),c("div",Z,[e("p",ee,m(r(o).error),1)])):f("",!0),e("div",null,[a[6]||(a[6]=e("label",{class:"block text-sm font-medium text-gray-300 mb-2"}," Nick ",-1)),w(e("input",{"onUpdate:modelValue":a[2]||(a[2]=t=>d.value=t),type:"text",required:"",minlength:"3",maxlength:"20",class:"w-full px-4 py-3 bg-dark-600 border border-dark-500 rounded-lg text-gray-100 placeholder-gray-500 focus:outline-none focus:border-primary-500",placeholder:"Seu nick no jogo"},null,512),[[S,d.value]])]),e("div",null,[a[7]||(a[7]=e("label",{class:"block text-sm font-medium text-gray-300 mb-2"}," Classe ",-1)),w(e("select",{"onUpdate:modelValue":a[3]||(a[3]=t=>p.value=t),required:"",class:"w-full px-4 py-3 bg-dark-600 border border-dark-500 rounded-lg text-gray-100 focus:outline-none focus:border-primary-500"},[(i(!0),c(_,null,T(r(x),t=>(i(),c("option",{key:t.value,value:t.value},m(t.label),9,te))),128))],512),[[O,p.value]])]),e("button",{type:"submit",disabled:r(o).updating,class:"w-full btn btn-primary py-3 flex items-center justify-center gap-2"},[r(o).updating?(i(),h(L,{key:0,size:"sm"})):f("",!0),e("span",null,m(r(o).updating?"Salvando...":"Salvar AlteraÃ§Ãµes"),1)],8,se)],32)])])],64))}}),oe=q(re,[["__scopeId","data-v-b5911208"]]),le={class:"fixed inset-x-0 bottom-0 z-50 animate-slide-up"},ae={class:"bg-dark-700 rounded-t-2xl max-h-[80vh] overflow-hidden flex flex-col"},ne={class:"flex items-center justify-between p-4 border-b border-dark-600"},ie={key:0,class:"bg-red-900/20 border border-red-500/30 rounded-lg p-3"},de={class:"text-red-400 text-sm"},ue={key:0,class:"text-red-400 text-sm mt-1"},ce=["disabled"],pe=z({__name:"ChangePasswordSheet",emits:["close"],setup(y,{emit:v}){const o=B(),l=v,n=g(""),d=g(""),p=g(""),x=V(()=>d.value===p.value),b=V(()=>n.value.length>=6&&d.value.length>=6&&x.value);async function s(){if(!b.value)return;await o.changePassword(n.value,d.value)&&l("close")}return(a,t)=>(i(),c(_,null,[e("div",{class:"fixed inset-0 bg-black/50 z-40",onClick:t[0]||(t[0]=u=>l("close"))}),e("div",le,[e("div",ae,[e("div",ne,[t[6]||(t[6]=e("h3",{class:"text-lg font-semibold text-gray-100"},"Alterar Senha",-1)),e("button",{onClick:t[1]||(t[1]=u=>l("close")),class:"p-2 hover:bg-dark-600 rounded-lg transition-colors"},[...t[5]||(t[5]=[e("svg",{class:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("form",{onSubmit:H(s,["prevent"]),class:"flex-1 overflow-y-auto p-4 space-y-4"},[r(o).error?(i(),c("div",ie,[e("p",de,m(r(o).error),1)])):f("",!0),e("div",null,[t[7]||(t[7]=e("label",{class:"block text-sm font-medium text-gray-300 mb-2"}," Senha Atual ",-1)),w(e("input",{"onUpdate:modelValue":t[2]||(t[2]=u=>n.value=u),type:"password",required:"",minlength:"6",class:"w-full px-4 py-3 bg-dark-600 border border-dark-500 rounded-lg text-gray-100 placeholder-gray-500 focus:outline-none focus:border-primary-500",placeholder:"Digite sua senha atual"},null,512),[[S,n.value]])]),e("div",null,[t[8]||(t[8]=e("label",{class:"block text-sm font-medium text-gray-300 mb-2"}," Nova Senha ",-1)),w(e("input",{"onUpdate:modelValue":t[3]||(t[3]=u=>d.value=u),type:"password",required:"",minlength:"6",class:"w-full px-4 py-3 bg-dark-600 border border-dark-500 rounded-lg text-gray-100 placeholder-gray-500 focus:outline-none focus:border-primary-500",placeholder:"MÃ­nimo 6 caracteres"},null,512),[[S,d.value]])]),e("div",null,[t[9]||(t[9]=e("label",{class:"block text-sm font-medium text-gray-300 mb-2"}," Confirmar Nova Senha ",-1)),w(e("input",{"onUpdate:modelValue":t[4]||(t[4]=u=>p.value=u),type:"password",required:"",minlength:"6",class:A(["w-full px-4 py-3 bg-dark-600 border border-dark-500 rounded-lg text-gray-100 placeholder-gray-500 focus:outline-none focus:border-primary-500",p.value&&!x.value?"border-red-500":""]),placeholder:"Repita a nova senha"},null,2),[[S,p.value]]),p.value&&!x.value?(i(),c("p",ue," As senhas nÃ£o conferem ")):f("",!0)]),e("button",{type:"submit",disabled:!b.value||r(o).changingPassword,class:"w-full btn btn-primary py-3 flex items-center justify-center gap-2 disabled:opacity-50"},[r(o).changingPassword?(i(),h(L,{key:0,size:"sm"})):f("",!0),e("span",null,m(r(o).changingPassword?"Alterando...":"Alterar Senha"),1)],8,ce)],32)])])],64))}}),fe=q(pe,[["__scopeId","data-v-36fe69fe"]]),me={class:"space-y-6"},ge={key:0,class:"flex justify-center py-12"},ve={class:"card"},ye={class:"flex flex-col items-center text-center"},be={class:"flex items-center gap-2 mb-1"},xe={class:"text-2xl font-bold text-gray-100"},ke={key:0,class:"text-xl"},we={class:"text-gray-400"},he={key:0,class:"mt-3 px-4 py-1.5 bg-primary-500/20 text-primary-400 rounded-full text-sm font-medium"},_e={key:0,class:"card"},Ce={class:"grid grid-cols-2 gap-4"},Se={class:"bg-dark-600 rounded-lg p-4 text-center"},Pe={class:"text-2xl font-bold text-primary-400"},Me={class:"bg-dark-600 rounded-lg p-4 text-center"},$e={class:"text-2xl font-bold text-primary-400"},je={class:"card"},Ae={class:"space-y-3"},Ee={class:"flex justify-between items-center py-2 border-b border-dark-600"},ze={class:"text-gray-100"},Le={key:0,class:"flex justify-between items-center py-2"},Be={class:"text-gray-100"},Ve={class:"space-y-3"},Ne={key:0,class:"fixed bottom-20 left-4 right-4 bg-green-500/90 text-white px-4 py-3 rounded-lg flex items-center justify-between z-50"},De={key:1,class:"fixed bottom-20 left-4 right-4 bg-red-500/90 text-white px-4 py-3 rounded-lg flex items-center justify-between z-50"},Ie=z({__name:"ProfileView",setup(y){const v=J(),o=E(),l=B(),n=g(!1),d=g(!1);D(()=>{l.fetchProfile()}),F(()=>l.successMessage,b=>{b&&setTimeout(()=>{l.clearSuccessMessage()},3e3)});function p(b){try{return new Date(b).toLocaleDateString("pt-BR",{day:"2-digit",month:"long",year:"numeric"})}catch{return"-"}}function x(){o.logout(),v.push("/web/login")}return(b,s)=>{const a=K("router-link");return i(),h(Q,null,{default:M(()=>[e("div",me,[r(l).loading&&!r(l).profile?(i(),c("div",ge,[$(L)])):(i(),c(_,{key:1},[e("div",ve,[e("div",ye,[e("div",{class:A(["w-24 h-24 rounded-full flex items-center justify-center mb-4",r(o).isLeader?"bg-primary-500":"bg-primary-500/20"])},[e("span",{class:A(["text-4xl font-bold",r(o).isLeader?"text-white":"text-primary-400"])},m(r(o).user?.nick?.charAt(0).toUpperCase()),3)],2),e("div",be,[e("h2",xe,m(r(o).user?.nick),1),r(o).isLeader?(i(),c("span",ke,"ðŸ‘‘")):f("",!0)]),e("p",we,m(r(N)[r(o).user?.playerClass]),1),r(o).isLeader?(i(),c("span",he," LÃ­der da Guilda ")):f("",!0)])]),r(l).profile?.stats?(i(),c("div",_e,[s[8]||(s[8]=e("h3",{class:"text-lg font-semibold text-gray-100 mb-4"},"EstatÃ­sticas",-1)),e("div",Ce,[e("div",Se,[e("p",Pe,m(r(l).profile.stats.messagesCount),1),s[6]||(s[6]=e("p",{class:"text-sm text-gray-400"},"Mensagens",-1))]),e("div",Me,[e("p",$e,m(r(l).profile.stats.eventsParticipated),1),s[7]||(s[7]=e("p",{class:"text-sm text-gray-400"},"Eventos",-1))])])])):f("",!0),e("div",je,[s[12]||(s[12]=e("h3",{class:"text-lg font-semibold text-gray-100 mb-4"},"InformaÃ§Ãµes",-1)),e("div",Ae,[s[11]||(s[11]=e("div",{class:"flex justify-between items-center py-2 border-b border-dark-600"},[e("span",{class:"text-gray-400"},"Status"),e("span",{class:"text-green-400"},"Ativo")],-1)),e("div",Ee,[s[9]||(s[9]=e("span",{class:"text-gray-400"},"Cargo",-1)),e("span",ze,m(r(o).user?.role===r(G).LEADER?"LÃ­der":"Membro"),1)]),r(l).profile?.createdAt?(i(),c("div",Le,[s[10]||(s[10]=e("span",{class:"text-gray-400"},"Membro desde",-1)),e("span",Be,m(p(r(l).profile.createdAt)),1)])):f("",!0)])]),e("div",Ve,[e("button",{onClick:s[0]||(s[0]=t=>n.value=!0),class:"btn-secondary w-full py-3 flex items-center justify-center gap-2"},[...s[13]||(s[13]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1),k(" Editar Perfil ",-1)])]),e("button",{onClick:s[1]||(s[1]=t=>d.value=!0),class:"btn-secondary w-full py-3 flex items-center justify-center gap-2"},[...s[14]||(s[14]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"})],-1),k(" Alterar Senha ",-1)])]),r(o).isLeader?(i(),c(_,{key:0},[$(a,{to:"/web/admin/pending",class:"btn-secondary w-full py-3 flex items-center justify-center gap-2"},{default:M(()=>[...s[15]||(s[15]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})],-1),k(" Membros Pendentes ",-1)])]),_:1}),$(a,{to:"/web/admin/banned",class:"btn-secondary w-full py-3 flex items-center justify-center gap-2"},{default:M(()=>[...s[16]||(s[16]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636"})],-1),k(" UsuÃ¡rios Banidos ",-1)])]),_:1})],64)):f("",!0),e("button",{onClick:x,class:"btn-ghost w-full py-3 text-red-400 hover:text-red-300 hover:bg-red-500/10 flex items-center justify-center gap-2"},[...s[17]||(s[17]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})],-1),k(" Sair da Conta ",-1)])])])],64))]),r(l).successMessage?(i(),c("div",Ne,[e("span",null,m(r(l).successMessage),1),e("button",{onClick:s[2]||(s[2]=t=>r(l).clearSuccessMessage()),class:"ml-4 font-bold"},"OK")])):f("",!0),r(l).error?(i(),c("div",De,[e("span",null,m(r(l).error),1),e("button",{onClick:s[3]||(s[3]=t=>r(l).clearError()),class:"ml-4 font-bold"},"OK")])):f("",!0),n.value?(i(),h(oe,{key:2,onClose:s[4]||(s[4]=t=>n.value=!1)})):f("",!0),d.value?(i(),h(fe,{key:3,onClose:s[5]||(s[5]=t=>d.value=!1)})):f("",!0)]),_:1})}}});export{Ie as default};
