import{d as L,r as h,c as _,y as U,a as i,n as D,b as e,e as p,t as c,i as P,F as j,s as S,f as u,o as l,z as H,A as F,B as J,C as T,T as R,D as V,E as G,G as N,j as K,w as E,v as M,P as Q,H as A,p as W,u as X,I as Y,J as Z}from"./index-B9jUeESS.js";const ee={class:"flex items-start justify-between gap-3"},te={class:"flex-1 min-w-0"},se={class:"flex items-center gap-2 mb-2"},ne={key:0,class:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-gray-500/20 text-gray-400"},ae={key:1,class:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-red-500/20 text-red-400"},le={class:"text-xs text-gray-500"},oe={class:"font-semibold text-gray-100 mb-1"},ie={key:0,class:"text-gray-400 text-sm mb-2"},re={class:"flex flex-wrap gap-3 text-xs text-gray-500"},de={class:"flex items-center gap-1"},ue={class:"flex items-center gap-1"},ce={key:2,class:"mt-2 flex flex-wrap gap-1"},ve={class:"ml-1 text-gray-500"},me={class:"text-xs text-gray-500 mt-2"},pe={class:"flex flex-col items-end gap-2 flex-shrink-0"},xe=["disabled"],z=L({__name:"EventCard",props:{event:{},currentUserId:{},canDelete:{type:Boolean},isPast:{type:Boolean}},emits:["join","leave","delete"],setup(d,{emit:y}){const s=d,k=y,x=h(!1),v=_(()=>s.currentUserId?s.event.participants.some(n=>n.id===s.currentUserId):!1),b=_(()=>s.event.maxParticipants?s.event.participants.length>=s.event.maxParticipants:!1),f=_(()=>{const n=s.event.participants.length,r=s.event.maxParticipants;return r?`${n}/${r}`:`${n}`}),g=_(()=>new Date(s.event.eventDate).toLocaleDateString("pt-BR",{weekday:"short",day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit"})),C=_(()=>!s.event.requiredClasses||s.event.requiredClasses.length===0?"Todas as classes":s.event.requiredClasses.map(n=>U[n]||n).join(", "));function o(){v.value?k("leave",s.event.id):k("join",s.event.id)}function t(){k("delete",s.event.id)}return(n,r)=>(l(),i("div",{class:D(["card",{"opacity-60":d.isPast}])},[e("div",ee,[e("div",te,[e("div",se,[d.isPast?(l(),i("span",ne," Encerrado ")):b.value?(l(),i("span",ae," Lotado ")):p("",!0),e("span",le,c(g.value),1)]),e("h4",oe,c(d.event.title),1),d.event.description?(l(),i("p",ie,c(d.event.description),1)):p("",!0),e("div",re,[e("span",de,[r[1]||(r[1]=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0z"})],-1)),P(" "+c(f.value)+" participantes ",1)]),e("span",ue,[r[2]||(r[2]=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})],-1)),P(" "+c(C.value),1)])]),d.event.participants.length>0?(l(),i("button",{key:1,onClick:r[0]||(r[0]=$=>x.value=!x.value),class:"mt-2 text-xs text-primary-400 hover:text-primary-300 flex items-center gap-1"},[(l(),i("svg",{class:D(["w-4 h-4 transition-transform",{"rotate-180":x.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...r[3]||(r[3]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])],2)),P(" "+c(x.value?"Ocultar":"Ver")+" participantes ",1)])):p("",!0),x.value&&d.event.participants.length>0?(l(),i("div",ce,[(l(!0),i(j,null,S(d.event.participants,$=>(l(),i("span",{key:$.id,class:D(["inline-flex items-center px-2 py-0.5 rounded text-xs bg-dark-600 text-gray-300",{"bg-primary-500/20 text-primary-400":$.id===d.currentUserId}])},[P(c($.nick)+" ",1),e("span",ve,c(u(U)[$.playerClass]),1)],2))),128))])):p("",!0),e("p",me," Por: "+c(d.event.createdBy.nick),1)]),e("div",pe,[d.canDelete?(l(),i("button",{key:0,onClick:t,class:"p-2 text-gray-500 hover:text-red-400 hover:bg-red-500/10 rounded-lg transition-colors",title:"Deletar evento"},[...r[4]||(r[4]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])])):p("",!0),d.isPast?p("",!0):(l(),i("button",{key:1,onClick:o,class:D(["btn text-sm",v.value?"btn-secondary":"btn-primary"]),disabled:!v.value&&b.value},c(v.value?"Sair":"Participar"),11,xe))])])],2))}}),fe={key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4"},be={class:"relative bg-dark-700 rounded-xl shadow-xl w-full max-w-lg max-h-[90vh] overflow-auto"},ge={key:0,class:"p-3 rounded-lg bg-red-900/20 border border-red-500/30 text-red-400 text-sm"},he=["disabled"],ye=["disabled"],ke={class:"grid grid-cols-2 gap-3"},we=["min","disabled"],Ce=["disabled"],_e=["disabled"],$e={class:"flex items-center justify-between mb-2"},De={class:"flex flex-wrap gap-2"},Pe=["onClick","disabled"],Ee={class:"text-xs text-gray-500 mt-1"},Me={class:"flex gap-3 pt-2"},je=["disabled"],Te=["disabled"],Be=L({__name:"CreateEventModal",props:{show:{type:Boolean}},emits:["update:show"],setup(d,{emit:y}){const s=d,k=y,x=H(),v=h(""),b=h(""),f=h(""),g=h(""),C=h(null),o=h([]),t=h(!1),n=h(null),r=Object.values(F),$=_(()=>new Date().toISOString().split("T")[0]);J(()=>s.show,w=>{w&&(v.value="",b.value="",f.value="",g.value="",C.value=null,o.value=[],n.value=null)});function B(){k("update:show",!1)}function I(w){const a=o.value.indexOf(w);a===-1?o.value.push(w):o.value.splice(a,1)}function q(){o.value.length===r.length?o.value=[]:o.value=[...r]}async function O(){if(!v.value.trim()||!f.value||!g.value){n.value="Preencha todos os campos obrigatórios";return}t.value=!0,n.value=null;try{const w=new Date(`${f.value}T${g.value}`);await x.createEvent({title:v.value.trim(),description:b.value.trim()||null,eventDate:w.toISOString(),maxParticipants:C.value||null,requiredClasses:o.value.length>0?o.value:void 0})?B():n.value=x.error||"Erro ao criar evento"}catch{n.value="Erro ao criar evento"}finally{t.value=!1}}return(w,a)=>(l(),T(R,{to:"body"},[V(G,{name:"modal"},{default:N(()=>[d.show?(l(),i("div",fe,[e("div",{class:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:B}),e("div",be,[e("div",{class:"flex items-center justify-between p-4 border-b border-dark-600"},[a[6]||(a[6]=e("h2",{class:"text-lg font-semibold text-gray-100"},"Novo Evento",-1)),e("button",{onClick:B,class:"p-1 text-gray-400 hover:text-gray-200 rounded-lg hover:bg-dark-600 transition-colors"},[...a[5]||(a[5]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("form",{onSubmit:K(O,["prevent"]),class:"p-4 space-y-4"},[n.value?(l(),i("div",ge,c(n.value),1)):p("",!0),e("div",null,[a[7]||(a[7]=e("label",{for:"title",class:"label"},"Título *",-1)),E(e("input",{id:"title","onUpdate:modelValue":a[0]||(a[0]=m=>v.value=m),type:"text",class:"input",placeholder:"Nome do evento",disabled:t.value,maxlength:"100"},null,8,he),[[M,v.value]])]),e("div",null,[a[8]||(a[8]=e("label",{for:"description",class:"label"},"Descrição",-1)),E(e("textarea",{id:"description","onUpdate:modelValue":a[1]||(a[1]=m=>b.value=m),class:"input min-h-[80px] resize-none",placeholder:"Descrição opcional...",disabled:t.value,maxlength:"500"},null,8,ye),[[M,b.value]])]),e("div",ke,[e("div",null,[a[9]||(a[9]=e("label",{for:"date",class:"label"},"Data *",-1)),E(e("input",{id:"date","onUpdate:modelValue":a[2]||(a[2]=m=>f.value=m),type:"date",class:"input",min:$.value,disabled:t.value},null,8,we),[[M,f.value]])]),e("div",null,[a[10]||(a[10]=e("label",{for:"time",class:"label"},"Horário *",-1)),E(e("input",{id:"time","onUpdate:modelValue":a[3]||(a[3]=m=>g.value=m),type:"time",class:"input",disabled:t.value},null,8,Ce),[[M,g.value]])])]),e("div",null,[a[11]||(a[11]=e("label",{for:"maxParticipants",class:"label"},"Máximo de Participantes",-1)),E(e("input",{id:"maxParticipants","onUpdate:modelValue":a[4]||(a[4]=m=>C.value=m),type:"number",class:"input",placeholder:"Sem limite",min:"1",max:"100",disabled:t.value},null,8,_e),[[M,C.value,void 0,{number:!0}]])]),e("div",null,[e("div",$e,[a[12]||(a[12]=e("label",{class:"label mb-0"},"Classes Permitidas",-1)),e("button",{type:"button",onClick:q,class:"text-xs text-primary-400 hover:text-primary-300"},c(o.value.length===u(r).length?"Desmarcar todas":"Selecionar todas"),1)]),e("div",De,[(l(!0),i(j,null,S(u(r),m=>(l(),i("button",{key:m,type:"button",onClick:Re=>I(m),class:D(["px-3 py-1.5 rounded-lg text-sm font-medium transition-colors",o.value.includes(m)?"bg-primary-500 text-dark-900":"bg-dark-600 text-gray-300 hover:bg-dark-500"]),disabled:t.value},c(u(Q)[m]),11,Pe))),128))]),e("p",Ee,c(o.value.length===0?"Todas as classes podem participar":`${o.value.length} classe(s) selecionada(s)`),1)]),e("div",Me,[e("button",{type:"button",onClick:B,class:"btn btn-secondary flex-1",disabled:t.value}," Cancelar ",8,je),e("button",{type:"submit",class:"btn btn-primary flex-1",disabled:t.value||!v.value.trim()||!f.value||!g.value},[t.value?(l(),T(A,{key:0,size:"sm",class:"mr-2"})):p("",!0),P(" "+c(t.value?"Criando...":"Criar Evento"),1)],8,Te)])],32)])])):p("",!0)]),_:1})]))}}),Se=W(Be,[["__scopeId","data-v-f2f03d84"]]),Ve={class:"space-y-6"},Le={class:"flex items-center justify-between"},Ue={class:"flex items-center gap-2"},ze=["disabled"],He={key:0,class:"flex justify-center py-8"},Ne={key:1,class:"card bg-red-900/20 border border-red-500/30"},Ae={class:"text-red-400 text-center"},Ie={key:2,class:"card text-center py-8"},qe={key:0},Oe={class:"space-y-3"},Fe={key:1},Je={class:"space-y-3"},Ke=L({__name:"EventsView",setup(d){const y=X(),s=H(),k=h(!1),x=_(()=>{const o=new Date;return s.events.filter(t=>new Date(t.eventDate)>=o).sort((t,n)=>new Date(t.eventDate).getTime()-new Date(n.eventDate).getTime())}),v=_(()=>{const o=new Date;return s.events.filter(t=>new Date(t.eventDate)<o).sort((t,n)=>new Date(n.eventDate).getTime()-new Date(t.eventDate).getTime())});Y(()=>{s.fetchEvents()});function b(){s.fetchEvents()}async function f(o){confirm("Tem certeza que deseja deletar este evento?")&&await s.deleteEvent(o)}async function g(o){await s.joinEvent(o)}async function C(o){await s.leaveEvent(o)}return(o,t)=>(l(),T(Z,null,{default:N(()=>[e("div",Ve,[e("div",Le,[e("div",Ue,[e("button",{onClick:b,class:"p-2 rounded-lg text-gray-400 hover:text-gray-200 hover:bg-dark-600 transition-colors",disabled:u(s).loading},[(l(),i("svg",{class:D(["w-5 h-5",{"animate-spin":u(s).loading}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...t[2]||(t[2]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)])],2))],8,ze)]),u(y).isLeader?(l(),i("button",{key:0,onClick:t[0]||(t[0]=n=>k.value=!0),class:"btn btn-primary text-sm"},[...t[3]||(t[3]=[e("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),P(" Novo Evento ",-1)])])):p("",!0)]),u(s).loading&&u(s).events.length===0?(l(),i("div",He,[V(A)])):u(s).error?(l(),i("div",Ne,[e("p",Ae,c(u(s).error),1),e("button",{onClick:b,class:"btn btn-secondary mt-3 mx-auto block"}," Tentar novamente ")])):u(s).events.length===0?(l(),i("div",Ie,[...t[4]||(t[4]=[e("svg",{class:"w-12 h-12 mx-auto text-gray-500 mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1),e("p",{class:"text-gray-400"},"Nenhum evento disponível",-1)])])):(l(),i(j,{key:3},[x.value.length>0?(l(),i("div",qe,[t[5]||(t[5]=e("h3",{class:"text-sm font-medium text-gray-400 uppercase tracking-wide mb-3"},"Próximos Eventos",-1)),e("div",Oe,[(l(!0),i(j,null,S(x.value,n=>(l(),T(z,{key:n.id,event:n,"current-user-id":u(y).user?.id,"can-delete":u(y).isLeader,onJoin:g,onLeave:C,onDelete:f},null,8,["event","current-user-id","can-delete"]))),128))])])):p("",!0),v.value.length>0?(l(),i("div",Fe,[t[6]||(t[6]=e("h3",{class:"text-sm font-medium text-gray-400 uppercase tracking-wide mb-3"},"Eventos Passados",-1)),e("div",Je,[(l(!0),i(j,null,S(v.value,n=>(l(),T(z,{key:n.id,event:n,"current-user-id":u(y).user?.id,"can-delete":u(y).isLeader,"is-past":!0,onDelete:f},null,8,["event","current-user-id","can-delete"]))),128))])])):p("",!0)],64))]),V(Se,{show:k.value,"onUpdate:show":t[1]||(t[1]=n=>k.value=n)},null,8,["show"])]),_:1}))}});export{Ke as default};
