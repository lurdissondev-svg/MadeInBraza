import{d as z,c as v,R as j,a as l,o as s,n as _,b as t,t as u,e as c,g as r,E as I,w,y as b,r as M,C as L,A as P,z as D,F as R,m as T,j as A}from"./index-CZitzd5D.js";import{u as E}from"./members-Dnp6yhy1.js";import{_ as V}from"./MainLayout.vue_vue_type_script_setup_true_lang-BGXrfI_D.js";import{_ as h}from"./LoadingSpinner.vue_vue_type_script_setup_true_lang-CUL6qR6H.js";import{C as B}from"./ConfirmDialog-DtUN2KVr.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const N={class:"flex items-center gap-3"},S={class:"flex-1 min-w-0"},U={class:"flex items-center gap-2"},q={key:0,class:"text-sm"},F={key:1,class:"text-xs text-gray-500"},H={class:"text-sm text-gray-400"},G={key:0,class:"flex items-center gap-1"},K=["disabled"],O={key:1,class:"w-5 h-5 text-yellow-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},J=["disabled"],Q={key:1,class:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},W=["disabled"],X={key:1,class:"w-5 h-5 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Y={key:1,class:"flex items-center"},Z=z({__name:"MemberCard",props:{member:{},isLeader:{type:Boolean},currentUserId:{},promotingId:{},demotingId:{},banningId:{}},emits:["click","promote","demote","ban"],setup(p,{emit:$}){const e=p,i=$,a=v(()=>e.member.role===j.LEADER),d=v(()=>e.member.id===e.currentUserId),y=v(()=>e.isLeader&&!a.value&&!d.value),k=v(()=>e.isLeader&&a.value&&!d.value),x=v(()=>e.isLeader&&!a.value&&!d.value),f=v(()=>e.promotingId===e.member.id),g=v(()=>e.demotingId===e.member.id),o=v(()=>e.banningId===e.member.id);return(m,n)=>(s(),l("div",{class:_(["card cursor-pointer transition-colors hover:bg-dark-600",a.value?"border-l-4 border-l-primary-500 bg-primary-500/5":""]),onClick:n[3]||(n[3]=C=>i("click"))},[t("div",N,[t("div",{class:_(["w-12 h-12 rounded-full flex items-center justify-center text-white font-bold text-lg",a.value?"bg-primary-500":"bg-dark-500"])},u(p.member.nick.charAt(0).toUpperCase()),3),t("div",S,[t("div",U,[t("span",{class:_(["font-semibold truncate",a.value?"text-primary-400":"text-gray-100"])},u(p.member.nick),3),a.value?(s(),l("span",q,"ðŸ‘‘")):c("",!0),d.value?(s(),l("span",F,"(vocÃª)")):c("",!0)]),t("span",H,u(r(I)[p.member.playerClass]),1)]),y.value||k.value||x.value?(s(),l("div",G,[y.value?(s(),l("button",{key:0,onClick:n[0]||(n[0]=w(C=>i("promote"),["stop"])),disabled:f.value,class:"p-2 rounded-lg hover:bg-dark-500 transition-colors disabled:opacity-50",title:"Promover a lÃ­der"},[f.value?(s(),b(h,{key:0,size:"sm"})):(s(),l("svg",O,[...n[4]||(n[4]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"},null,-1)])]))],8,K)):c("",!0),k.value?(s(),l("button",{key:1,onClick:n[1]||(n[1]=w(C=>i("demote"),["stop"])),disabled:g.value,class:"p-2 rounded-lg hover:bg-dark-500 transition-colors disabled:opacity-50",title:"Rebaixar para membro"},[g.value?(s(),b(h,{key:0,size:"sm"})):(s(),l("svg",Q,[...n[5]||(n[5]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 14l-7 7m0 0l-7-7m7 7V3"},null,-1)])]))],8,J)):c("",!0),x.value?(s(),l("button",{key:2,onClick:n[2]||(n[2]=w(C=>i("ban"),["stop"])),disabled:o.value,class:"p-2 rounded-lg hover:bg-dark-500 transition-colors disabled:opacity-50",title:"Banir membro"},[o.value?(s(),b(h,{key:0,size:"sm"})):(s(),l("svg",X,[...n[6]||(n[6]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636"},null,-1)])]))],8,W)):c("",!0)])):(s(),l("div",Y,[t("span",{class:_(["px-2 py-1 text-xs rounded-full",a.value?"bg-primary-500/20 text-primary-400":"bg-dark-500 text-gray-400"])},u(a.value?"LÃ­der":"Membro"),3)]))])],2))}}),ee={class:"space-y-4"},te={class:"flex items-center justify-between"},se={class:"text-sm text-gray-400"},oe={class:"flex gap-4 text-sm"},re={class:"flex items-center gap-2"},ne={class:"text-primary-400"},ae={class:"flex items-center gap-2"},le={class:"text-gray-300"},ie={key:0,class:"flex justify-center py-12"},de={key:1,class:"card bg-red-900/20 border border-red-500/30"},me={class:"text-red-400"},ue={key:2,class:"card text-center py-8"},ce={key:3,class:"space-y-2"},ve={key:0,class:"fixed bottom-20 left-4 right-4 bg-red-500/90 text-white px-4 py-3 rounded-lg flex items-center justify-between z-50"},fe=z({__name:"MembersView",setup(p){const $=A(),e=E(),i=M(null),a=M(null),d=M(null);L(()=>{e.fetchMembers()});function y(g){$.push(`/web/members/${g.id}`)}async function k(){i.value&&(await e.promoteMember(i.value.id),i.value=null)}async function x(){a.value&&(await e.demoteMember(a.value.id),a.value=null)}async function f(){d.value&&(await e.banMember(d.value.id),d.value=null)}return(g,o)=>(s(),b(V,null,{default:P(()=>[t("div",ee,[t("div",te,[o[5]||(o[5]=t("h2",{class:"text-xl font-bold text-gray-100"},"Membros da Guilda",-1)),t("div",se,u(r(e).members.length)+" membros ",1)]),t("div",oe,[t("div",re,[t("span",ne,"ðŸ‘‘ "+u(r(e).leaderCount),1),o[6]||(o[6]=t("span",{class:"text-gray-500"},"lÃ­deres",-1))]),t("div",ae,[t("span",le,u(r(e).memberCount),1),o[7]||(o[7]=t("span",{class:"text-gray-500"},"membros",-1))])]),r(e).loading&&r(e).members.length===0?(s(),l("div",ie,[D(h)])):r(e).error&&r(e).members.length===0?(s(),l("div",de,[t("p",me,u(r(e).error),1),t("button",{onClick:o[0]||(o[0]=m=>r(e).fetchMembers()),class:"mt-4 btn btn-primary"}," Tentar novamente ")])):r(e).members.length===0?(s(),l("div",ue,[...o[8]||(o[8]=[t("svg",{class:"w-16 h-16 mx-auto text-gray-500 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})],-1),t("p",{class:"text-gray-400"},"Nenhum membro encontrado",-1)])])):(s(),l("div",ce,[(s(!0),l(R,null,T(r(e).sortedMembers,m=>(s(),b(Z,{key:m.id,member:m,"is-leader":r(e).isLeader,"current-user-id":r(e).currentUserId,"promoting-id":r(e).promotingId,"demoting-id":r(e).demotingId,"banning-id":r(e).banningId,onClick:n=>y(m),onPromote:n=>i.value=m,onDemote:n=>a.value=m,onBan:n=>d.value=m},null,8,["member","is-leader","current-user-id","promoting-id","demoting-id","banning-id","onClick","onPromote","onDemote","onBan"]))),128))]))]),r(e).error&&r(e).members.length>0?(s(),l("div",ve,[t("span",null,u(r(e).error),1),t("button",{onClick:o[1]||(o[1]=m=>r(e).clearError()),class:"ml-4 font-bold"},"OK")])):c("",!0),i.value?(s(),b(B,{key:1,title:"Promover a LÃ­der",message:`Tem certeza que deseja promover ${i.value.nick} a lÃ­der?`,"confirm-text":"Promover",onConfirm:k,onCancel:o[2]||(o[2]=m=>i.value=null)},null,8,["message"])):c("",!0),a.value?(s(),b(B,{key:2,title:"Rebaixar para Membro",message:`Tem certeza que deseja rebaixar ${a.value.nick} para membro?`,"confirm-text":"Rebaixar",onConfirm:x,onCancel:o[3]||(o[3]=m=>a.value=null)},null,8,["message"])):c("",!0),d.value?(s(),b(B,{key:3,title:"Banir Membro",message:`Tem certeza que deseja banir ${d.value.nick}? Esta aÃ§Ã£o pode ser revertida.`,"confirm-text":"Banir","confirm-variant":"danger",onConfirm:f,onCancel:o[4]||(o[4]=m=>d.value=null)},null,8,["message"])):c("",!0)]),_:1}))}});export{fe as default};
