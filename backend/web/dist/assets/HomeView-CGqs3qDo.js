import{q as M,s as D,r as h,d as j,c as w,a as i,o as a,b as e,e as k,i as _,t as v,x as E,y as C,T,z as y,A as g,w as H,f as B,v as z,B as N,u as L,P as U,C as P,D as W,g as m,n as q,F as R,m as F}from"./index-CZitzd5D.js";import{_ as I}from"./MainLayout.vue_vue_type_script_setup_true_lang-BGXrfI_D.js";import{_ as V}from"./LoadingSpinner.vue_vue_type_script_setup_true_lang-CUL6qR6H.js";import{_ as O}from"./_plugin-vue_export-helper-DlAUqK2U.js";const $={async getAnnouncements(){return(await M.get("/announcements")).data.announcements},async createAnnouncement(s){return(await M.post("/announcements",s)).data.announcement},async deleteAnnouncement(s){await M.delete(`/announcements/${s}`)}},S=D("announcements",()=>{const s=h([]),r=h(!1),n=h(null);async function p(){r.value=!0,n.value=null;try{return s.value=await $.getAnnouncements(),!0}catch(o){return n.value=o instanceof Error?o.message:"Erro ao carregar avisos",!1}finally{r.value=!1}}async function f(o){r.value=!0,n.value=null;try{const t=await $.createAnnouncement(o);return s.value.unshift(t),!0}catch(t){return n.value=t instanceof Error?t.message:"Erro ao criar aviso",!1}finally{r.value=!1}}async function c(o){r.value=!0,n.value=null;try{return await $.deleteAnnouncement(o),s.value=s.value.filter(t=>t.id!==o),!0}catch(t){return n.value=t instanceof Error?t.message:"Erro ao deletar aviso",!1}finally{r.value=!1}}function d(){n.value=null}return{announcements:s,loading:r,error:n,fetchAnnouncements:p,createAnnouncement:f,deleteAnnouncement:c,clearError:d}}),G={class:"card"},J={class:"flex items-start justify-between gap-3"},K={class:"flex-1 min-w-0"},Q={class:"flex items-center gap-2 mb-2"},X={key:0,class:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-green-500/20 text-green-400"},Y={key:1,class:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-primary-500/20 text-primary-400"},Z={class:"text-xs text-gray-500"},ee={class:"font-semibold text-gray-100 mb-1"},te={class:"text-gray-400 text-sm whitespace-pre-wrap"},ne={key:0,class:"mt-3"},se=["src","alt"],oe=["src"],ae=["href"],re={class:"text-xs text-gray-500 mt-2"},le=j({__name:"AnnouncementCard",props:{announcement:{},canDelete:{type:Boolean}},emits:["delete"],setup(s,{emit:r}){const n=s,p=r,f=w(()=>!!n.announcement.whatsappMessageId),c=w(()=>n.announcement.whatsappAuthor?n.announcement.whatsappAuthor:n.announcement.createdBy?.nick||"Sistema"),d=w(()=>{const t=n.announcement.whatsappTimestamp||n.announcement.createdAt;return new Date(t).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})});function o(){p("delete",n.announcement.id)}return(t,l)=>(a(),i("div",G,[e("div",J,[e("div",K,[e("div",Q,[f.value?(a(),i("span",X,[...l[0]||(l[0]=[e("svg",{class:"w-3 h-3 mr-1",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"})],-1),_(" WhatsApp ",-1)])])):(a(),i("span",Y," App ")),e("span",Z,v(d.value),1)]),e("h4",ee,v(s.announcement.title),1),e("p",te,v(s.announcement.content),1),s.announcement.mediaUrl?(a(),i("div",ne,[s.announcement.mediaType?.startsWith("image/")?(a(),i("img",{key:0,src:s.announcement.mediaUrl,alt:s.announcement.title,class:"rounded-lg max-h-48 object-cover"},null,8,se)):s.announcement.mediaType?.startsWith("video/")?(a(),i("video",{key:1,src:s.announcement.mediaUrl,controls:"",class:"rounded-lg max-h-48 w-full"},null,8,oe)):(a(),i("a",{key:2,href:s.announcement.mediaUrl,target:"_blank",rel:"noopener noreferrer",class:"inline-flex items-center text-primary-400 hover:text-primary-300 text-sm"},[...l[1]||(l[1]=[e("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),_(" Ver arquivo ",-1)])],8,ae))])):k("",!0),e("p",re," Por: "+v(c.value),1)]),s.canDelete&&!f.value?(a(),i("button",{key:0,onClick:o,class:"p-2 text-gray-500 hover:text-red-400 hover:bg-red-500/10 rounded-lg transition-colors flex-shrink-0",title:"Deletar aviso"},[...l[2]||(l[2]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])])):k("",!0)])]))}}),ie={key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4"},ce={class:"relative bg-dark-700 rounded-xl shadow-xl w-full max-w-md max-h-[90vh] overflow-auto"},de={key:0,class:"p-3 rounded-lg bg-red-900/20 border border-red-500/30 text-red-400 text-sm"},ue=["disabled"],me=["disabled"],ve={class:"text-xs text-gray-500 mt-1 text-right"},pe={class:"flex gap-3 pt-2"},fe=["disabled"],he=["disabled"],xe=j({__name:"CreateAnnouncementModal",props:{show:{type:Boolean}},emits:["update:show"],setup(s,{emit:r}){const n=s,p=r,f=S(),c=h(""),d=h(""),o=h(!1),t=h(null);E(()=>n.show,b=>{b&&(c.value="",d.value="",t.value=null)});function l(){p("update:show",!1)}async function x(){if(!c.value.trim()||!d.value.trim()){t.value="Preencha todos os campos";return}o.value=!0,t.value=null;try{await f.createAnnouncement({title:c.value.trim(),content:d.value.trim()})?l():t.value=f.error||"Erro ao criar aviso"}catch{t.value="Erro ao criar aviso"}finally{o.value=!1}}return(b,u)=>(a(),C(T,{to:"body"},[y(N,{name:"modal"},{default:g(()=>[s.show?(a(),i("div",ie,[e("div",{class:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:l}),e("div",ce,[e("div",{class:"flex items-center justify-between p-4 border-b border-dark-600"},[u[3]||(u[3]=e("h2",{class:"text-lg font-semibold text-gray-100"},"Novo Aviso",-1)),e("button",{onClick:l,class:"p-1 text-gray-400 hover:text-gray-200 rounded-lg hover:bg-dark-600 transition-colors"},[...u[2]||(u[2]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("form",{onSubmit:H(x,["prevent"]),class:"p-4 space-y-4"},[t.value?(a(),i("div",de,v(t.value),1)):k("",!0),e("div",null,[u[4]||(u[4]=e("label",{for:"title",class:"label"},"Título",-1)),B(e("input",{id:"title","onUpdate:modelValue":u[0]||(u[0]=A=>c.value=A),type:"text",class:"input",placeholder:"Título do aviso",disabled:o.value,maxlength:"100"},null,8,ue),[[z,c.value]])]),e("div",null,[u[5]||(u[5]=e("label",{for:"content",class:"label"},"Conteúdo",-1)),B(e("textarea",{id:"content","onUpdate:modelValue":u[1]||(u[1]=A=>d.value=A),class:"input min-h-[120px] resize-none",placeholder:"Escreva o conteúdo do aviso...",disabled:o.value,maxlength:"1000"},null,8,me),[[z,d.value]]),e("p",ve,v(d.value.length)+"/1000 ",1)]),e("div",pe,[e("button",{type:"button",onClick:l,class:"btn btn-secondary flex-1",disabled:o.value}," Cancelar ",8,fe),e("button",{type:"submit",class:"btn btn-primary flex-1",disabled:o.value||!c.value.trim()||!d.value.trim()},[o.value?(a(),C(V,{key:0,size:"sm",class:"mr-2"})):k("",!0),_(" "+v(o.value?"Criando...":"Criar Aviso"),1)],8,he)])],32)])])):k("",!0)]),_:1})]))}}),ye=O(xe,[["__scopeId","data-v-fee0565a"]]),ge={class:"space-y-6"},ke={class:"card"},be={class:"flex items-center gap-4"},we={class:"w-14 h-14 sm:w-16 sm:h-16 rounded-full bg-primary-500/20 flex items-center justify-center flex-shrink-0"},_e={class:"text-2xl sm:text-3xl font-bold text-primary-400"},Ce={class:"min-w-0"},Ae={class:"text-xl sm:text-2xl font-bold text-gray-100 truncate"},Me={class:"text-gray-400 text-sm sm:text-base"},$e={class:"flex items-center justify-between mb-3"},je={class:"flex items-center gap-2"},Be=["disabled"],ze={key:0,class:"flex justify-center py-8"},Ve={key:1,class:"card bg-red-900/20 border border-red-500/30"},Se={class:"text-red-400 text-center"},De={key:2,class:"card text-center py-8"},Ee={key:3,class:"space-y-3"},Te={class:"grid grid-cols-2 sm:grid-cols-4 gap-3"},Pe=j({__name:"HomeView",setup(s){const r=L(),n=S(),p=h(!1),f=w(()=>r.user?.playerClass?U[r.user.playerClass]:"");P(()=>{n.fetchAnnouncements()});function c(){n.fetchAnnouncements()}async function d(o){confirm("Tem certeza que deseja deletar este aviso?")&&await n.deleteAnnouncement(o)}return(o,t)=>{const l=W("router-link");return a(),C(I,null,{default:g(()=>[e("div",ge,[e("div",ke,[e("div",be,[e("div",we,[e("span",_e,v(m(r).user?.nick?.charAt(0).toUpperCase()),1)]),e("div",Ce,[e("h2",Ae," Olá, "+v(m(r).user?.nick)+"! ",1),e("p",Me,v(f.value)+" • Made in Braza ",1)])])]),e("div",null,[e("div",$e,[t[4]||(t[4]=e("h3",{class:"text-lg font-semibold text-gray-100"},"Avisos",-1)),e("div",je,[e("button",{onClick:c,class:"p-2 rounded-lg text-gray-400 hover:text-gray-200 hover:bg-dark-600 transition-colors",disabled:m(n).loading},[(a(),i("svg",{class:q(["w-5 h-5",{"animate-spin":m(n).loading}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...t[2]||(t[2]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)])],2))],8,Be),m(r).isLeader?(a(),i("button",{key:0,onClick:t[0]||(t[0]=x=>p.value=!0),class:"btn btn-primary text-sm"},[...t[3]||(t[3]=[e("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),_(" Novo ",-1)])])):k("",!0)])]),m(n).loading&&m(n).announcements.length===0?(a(),i("div",ze,[y(V)])):m(n).error?(a(),i("div",Ve,[e("p",Se,v(m(n).error),1),e("button",{onClick:c,class:"btn btn-secondary mt-3 mx-auto block"}," Tentar novamente ")])):m(n).announcements.length===0?(a(),i("div",De,[...t[5]||(t[5]=[e("svg",{class:"w-12 h-12 mx-auto text-gray-500 mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5.882V19.24a1.76 1.76 0 01-3.417.592l-2.147-6.15M18 13a3 3 0 100-6M5.436 13.683A4.001 4.001 0 017 6h1.832c4.1 0 7.625-1.234 9.168-3v14c-1.543-1.766-5.067-3-9.168-3H7a3.988 3.988 0 01-1.564-.317z"})],-1),e("p",{class:"text-gray-400"},"Nenhum aviso disponível",-1)])])):(a(),i("div",Ee,[(a(!0),i(R,null,F(m(n).announcements,x=>(a(),C(le,{key:x.id,announcement:x,"can-delete":m(r).isLeader,onDelete:d},null,8,["announcement","can-delete"]))),128))]))]),e("div",null,[t[10]||(t[10]=e("h3",{class:"text-lg font-semibold text-gray-100 mb-3"},"Acesso Rápido",-1)),e("div",Te,[y(l,{to:"/siege-war",class:"card flex flex-col items-center justify-center py-6 hover:bg-dark-600 transition-colors"},{default:g(()=>[...t[6]||(t[6]=[e("svg",{class:"w-8 h-8 text-primary-400 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),e("span",{class:"text-sm font-medium text-gray-300"},"Siege War",-1)])]),_:1}),y(l,{to:"/events",class:"card flex flex-col items-center justify-center py-6 hover:bg-dark-600 transition-colors"},{default:g(()=>[...t[7]||(t[7]=[e("svg",{class:"w-8 h-8 text-primary-400 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1),e("span",{class:"text-sm font-medium text-gray-300"},"Eventos",-1)])]),_:1}),y(l,{to:"/parties",class:"card flex flex-col items-center justify-center py-6 hover:bg-dark-600 transition-colors"},{default:g(()=>[...t[8]||(t[8]=[e("svg",{class:"w-8 h-8 text-primary-400 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})],-1),e("span",{class:"text-sm font-medium text-gray-300"},"Parties",-1)])]),_:1}),y(l,{to:"/channels",class:"card flex flex-col items-center justify-center py-6 hover:bg-dark-600 transition-colors"},{default:g(()=>[...t[9]||(t[9]=[e("svg",{class:"w-8 h-8 text-primary-400 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})],-1),e("span",{class:"text-sm font-medium text-gray-300"},"Chat",-1)])]),_:1})])])]),y(ye,{show:p.value,"onUpdate:show":t[1]||(t[1]=x=>p.value=x)},null,8,["show"])]),_:1})}}});export{Pe as default};
