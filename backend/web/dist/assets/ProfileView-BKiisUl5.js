import{x as A,y as F,r as y,u as j,d as H,H as G,P as q,E as D,a as c,o as i,b as e,j as T,e as g,f as r,t as b,w as M,v as E,p as O,F as $,q as K,A as C,c as L,n as V,z as J,C as U,B,R as W,i as S,N as Q,k as X}from"./index-BCVEqFNE.js";import{_ as Y}from"./MainLayout.vue_vue_type_script_setup_true_lang-CIQawBsX.js";import{_ as z}from"./LoadingSpinner.vue_vue_type_script_setup_true_lang-DLfi4Sx-.js";import{_ as I}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./braza_logo-Cfl0RS0W.js";const P={async getProfile(){return(await A.get("/profile")).data.profile},async updateProfile(p){return(await A.put("/profile",p)).data.profile},async changePassword(p,m){const o={currentPassword:p,newPassword:m};await A.put("/auth/change-password",o)},async uploadAvatar(p){const m=new FormData;return m.append("avatar",p),(await A.post("/profile/avatar",m,{headers:{"Content-Type":"multipart/form-data"}})).data.user},async deleteAvatar(){return(await A.delete("/profile/avatar")).data.user}},N=F("profile",()=>{const p=y(null),m=y(!1),o=y(!1),s=y(!1),f=y(!1),l=y(null),d=y(null);async function x(){m.value=!0,l.value=null;try{p.value=await P.getProfile()}catch(t){const n=t;l.value=n.response?.data?.message||"Erro ao carregar perfil",console.error("Error fetching profile:",t)}finally{m.value=!1}}async function _(t){o.value=!0,l.value=null;try{p.value=await P.updateProfile(t);const n=j();return n.user&&(t.nick&&(n.user.nick=t.nick),t.playerClass&&(n.user.playerClass=t.playerClass)),d.value="Perfil atualizado com sucesso!",!0}catch(n){const v=n;return l.value=v.response?.data?.message||"Erro ao atualizar perfil",console.error("Error updating profile:",n),!1}finally{o.value=!1}}async function w(t,n){f.value=!0,l.value=null;try{return await P.changePassword(t,n),d.value="Senha alterada com sucesso!",!0}catch(v){const R=v;return l.value=R.response?.data?.message||"Erro ao alterar senha",console.error("Error changing password:",v),!1}finally{f.value=!1}}async function u(t){s.value=!0,l.value=null;try{const n=await P.uploadAvatar(t);p.value&&(p.value.avatarUrl=n.avatarUrl);const v=j();return v.user&&(v.user.avatarUrl=n.avatarUrl),d.value="Foto de perfil atualizada!",!0}catch(n){const v=n;return l.value=v.response?.data?.message||"Erro ao atualizar foto de perfil",console.error("Error uploading avatar:",n),!1}finally{s.value=!1}}async function a(){s.value=!0,l.value=null;try{await P.deleteAvatar(),p.value&&(p.value.avatarUrl=null);const t=j();return t.user&&(t.user.avatarUrl=null),d.value="Foto de perfil removida!",!0}catch(t){const n=t;return l.value=n.response?.data?.message||"Erro ao remover foto de perfil",console.error("Error deleting avatar:",t),!1}finally{s.value=!1}}function k(){l.value=null}function h(){d.value=null}return{profile:p,loading:m,updating:o,uploadingAvatar:s,changingPassword:f,error:l,successMessage:d,fetchProfile:x,updateProfile:_,uploadAvatar:u,deleteAvatar:a,changePassword:w,clearError:k,clearSuccessMessage:h}}),Z={class:"fixed inset-x-0 bottom-0 z-50 animate-slide-up"},ee={class:"bg-dark-700 rounded-t-2xl max-h-[80vh] overflow-hidden flex flex-col"},te={class:"flex items-center justify-between p-4 border-b border-dark-600"},se={key:0,class:"bg-red-900/20 border border-red-500/30 rounded-lg p-3"},re={class:"text-red-400 text-sm"},ae=["value"],oe=["disabled"],le=H({__name:"EditProfileSheet",emits:["close"],setup(p,{emit:m}){const o=N(),s=j(),f=m,l=y(""),d=y(G.ASSASSIN),x=Object.entries(q).map(([w,u])=>({value:w,label:u}));D(()=>{s.user&&(l.value=s.user.nick,d.value=s.user.playerClass)});async function _(){await o.updateProfile({nick:l.value,playerClass:d.value})&&f("close")}return(w,u)=>(i(),c($,null,[e("div",{class:"fixed inset-0 bg-black/50 z-40",onClick:u[0]||(u[0]=a=>f("close"))}),e("div",Z,[e("div",ee,[e("div",te,[u[5]||(u[5]=e("h3",{class:"text-lg font-semibold text-gray-100"},"Editar Perfil",-1)),e("button",{onClick:u[1]||(u[1]=a=>f("close")),class:"p-2 hover:bg-dark-600 rounded-lg transition-colors"},[...u[4]||(u[4]=[e("svg",{class:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("form",{onSubmit:T(_,["prevent"]),class:"flex-1 overflow-y-auto p-4 space-y-4"},[r(o).error?(i(),c("div",se,[e("p",re,b(r(o).error),1)])):g("",!0),e("div",null,[u[6]||(u[6]=e("label",{class:"block text-sm font-medium text-gray-300 mb-2"}," Nick ",-1)),M(e("input",{"onUpdate:modelValue":u[2]||(u[2]=a=>l.value=a),type:"text",required:"",minlength:"3",maxlength:"20",class:"w-full px-4 py-3 bg-dark-600 border border-dark-500 rounded-lg text-gray-100 placeholder-gray-500 focus:outline-none focus:border-primary-500",placeholder:"Seu nick no jogo"},null,512),[[E,l.value]])]),e("div",null,[u[7]||(u[7]=e("label",{class:"block text-sm font-medium text-gray-300 mb-2"}," Classe ",-1)),M(e("select",{"onUpdate:modelValue":u[3]||(u[3]=a=>d.value=a),required:"",class:"w-full px-4 py-3 bg-dark-600 border border-dark-500 rounded-lg text-gray-100 focus:outline-none focus:border-primary-500"},[(i(!0),c($,null,K(r(x),a=>(i(),c("option",{key:a.value,value:a.value},b(a.label),9,ae))),128))],512),[[O,d.value]])]),e("button",{type:"submit",disabled:r(o).updating,class:"w-full btn btn-primary py-3 flex items-center justify-center gap-2"},[r(o).updating?(i(),C(z,{key:0,size:"sm"})):g("",!0),e("span",null,b(r(o).updating?"Salvando...":"Salvar AlteraÃ§Ãµes"),1)],8,oe)],32)])])],64))}}),ne=I(le,[["__scopeId","data-v-b5911208"]]),ie={class:"fixed inset-x-0 bottom-0 z-50 animate-slide-up"},ue={class:"bg-dark-700 rounded-t-2xl max-h-[80vh] overflow-hidden flex flex-col"},de={class:"flex items-center justify-between p-4 border-b border-dark-600"},ce={key:0,class:"bg-red-900/20 border border-red-500/30 rounded-lg p-3"},pe={class:"text-red-400 text-sm"},fe={key:0,class:"text-red-400 text-sm mt-1"},ve=["disabled"],me=H({__name:"ChangePasswordSheet",emits:["close"],setup(p,{emit:m}){const o=N(),s=m,f=y(""),l=y(""),d=y(""),x=L(()=>l.value===d.value),_=L(()=>f.value.length>=6&&l.value.length>=6&&x.value);async function w(){if(!_.value)return;await o.changePassword(f.value,l.value)&&s("close")}return(u,a)=>(i(),c($,null,[e("div",{class:"fixed inset-0 bg-black/50 z-40",onClick:a[0]||(a[0]=k=>s("close"))}),e("div",ie,[e("div",ue,[e("div",de,[a[6]||(a[6]=e("h3",{class:"text-lg font-semibold text-gray-100"},"Alterar Senha",-1)),e("button",{onClick:a[1]||(a[1]=k=>s("close")),class:"p-2 hover:bg-dark-600 rounded-lg transition-colors"},[...a[5]||(a[5]=[e("svg",{class:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("form",{onSubmit:T(w,["prevent"]),class:"flex-1 overflow-y-auto p-4 space-y-4"},[r(o).error?(i(),c("div",ce,[e("p",pe,b(r(o).error),1)])):g("",!0),e("div",null,[a[7]||(a[7]=e("label",{class:"block text-sm font-medium text-gray-300 mb-2"}," Senha Atual ",-1)),M(e("input",{"onUpdate:modelValue":a[2]||(a[2]=k=>f.value=k),type:"password",required:"",minlength:"6",class:"w-full px-4 py-3 bg-dark-600 border border-dark-500 rounded-lg text-gray-100 placeholder-gray-500 focus:outline-none focus:border-primary-500",placeholder:"Digite sua senha atual"},null,512),[[E,f.value]])]),e("div",null,[a[8]||(a[8]=e("label",{class:"block text-sm font-medium text-gray-300 mb-2"}," Nova Senha ",-1)),M(e("input",{"onUpdate:modelValue":a[3]||(a[3]=k=>l.value=k),type:"password",required:"",minlength:"6",class:"w-full px-4 py-3 bg-dark-600 border border-dark-500 rounded-lg text-gray-100 placeholder-gray-500 focus:outline-none focus:border-primary-500",placeholder:"MÃ­nimo 6 caracteres"},null,512),[[E,l.value]])]),e("div",null,[a[9]||(a[9]=e("label",{class:"block text-sm font-medium text-gray-300 mb-2"}," Confirmar Nova Senha ",-1)),M(e("input",{"onUpdate:modelValue":a[4]||(a[4]=k=>d.value=k),type:"password",required:"",minlength:"6",class:V(["w-full px-4 py-3 bg-dark-600 border border-dark-500 rounded-lg text-gray-100 placeholder-gray-500 focus:outline-none focus:border-primary-500",d.value&&!x.value?"border-red-500":""]),placeholder:"Repita a nova senha"},null,2),[[E,d.value]]),d.value&&!x.value?(i(),c("p",fe," As senhas nÃ£o conferem ")):g("",!0)]),e("button",{type:"submit",disabled:!_.value||r(o).changingPassword,class:"w-full btn btn-primary py-3 flex items-center justify-center gap-2 disabled:opacity-50"},[r(o).changingPassword?(i(),C(z,{key:0,size:"sm"})):g("",!0),e("span",null,b(r(o).changingPassword?"Alterando...":"Alterar Senha"),1)],8,ve)],32)])])],64))}}),ge=I(me,[["__scopeId","data-v-36fe69fe"]]),ye={class:"space-y-6"},be={key:0,class:"flex justify-center py-12"},xe={class:"card"},ke={class:"flex flex-col items-center text-center"},he={class:"relative mb-4"},we=["src"],_e=["disabled"],Ce={key:0,class:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Ae={class:"flex items-center gap-2 mb-1"},Se={class:"text-2xl font-bold text-gray-100"},Pe={key:0,class:"text-xl"},je={class:"text-gray-400"},Me={key:0,class:"mt-3 px-4 py-1.5 bg-primary-500/20 text-primary-400 rounded-full text-sm font-medium"},$e={key:0,class:"card"},Ee={class:"grid grid-cols-2 gap-4"},ze={class:"bg-dark-600 rounded-lg p-4 text-center"},Ue={class:"text-2xl font-bold text-primary-400"},Be={class:"bg-dark-600 rounded-lg p-4 text-center"},Le={class:"text-2xl font-bold text-primary-400"},Ve={class:"card"},He={class:"space-y-3"},Ne={class:"flex justify-between items-center py-2 border-b border-dark-600"},qe={class:"text-gray-100"},De={key:0,class:"flex justify-between items-center py-2"},Te={class:"text-gray-100"},Ie={class:"space-y-3"},Re={key:0,class:"fixed bottom-20 left-4 right-4 bg-green-500/90 text-white px-4 py-3 rounded-lg flex items-center justify-between z-50"},Fe={key:1,class:"fixed bottom-20 left-4 right-4 bg-red-500/90 text-white px-4 py-3 rounded-lg flex items-center justify-between z-50"},Qe=H({__name:"ProfileView",setup(p){const m=X(),o=j(),s=N(),f=y(!1),l=y(!1),d=y(null),x=L(()=>{const h=s.profile?.avatarUrl||o.user?.avatarUrl;return h?`${h}`:null});D(()=>{s.fetchProfile()}),J(()=>s.successMessage,h=>{h&&setTimeout(()=>{s.clearSuccessMessage()},3e3)});function _(h){try{return new Date(h).toLocaleDateString("pt-BR",{day:"2-digit",month:"long",year:"numeric"})}catch{return"-"}}function w(){o.logout(),m.push("/login")}function u(){d.value?.click()}async function a(h){const t=h.target,n=t.files?.[0];if(n){if(!["image/jpeg","image/png","image/webp","image/gif"].includes(n.type)){s.error="Tipo de arquivo invÃ¡lido. Use JPEG, PNG, WebP ou GIF.";return}if(n.size>20*1024*1024){s.error="Arquivo muito grande. MÃ¡ximo 20MB.";return}await s.uploadAvatar(n)}t.value=""}async function k(){confirm("Tem certeza que deseja remover sua foto de perfil?")&&await s.deleteAvatar()}return(h,t)=>{const n=Q("router-link");return i(),C(Y,null,{default:U(()=>[e("div",ye,[r(s).loading&&!r(s).profile?(i(),c("div",be,[B(z)])):(i(),c($,{key:1},[e("input",{ref_key:"avatarInput",ref:d,type:"file",accept:"image/jpeg,image/png,image/webp,image/gif",class:"hidden",onChange:a},null,544),e("div",xe,[e("div",ke,[e("div",he,[e("div",{class:V(["w-32 h-32 rounded-full flex items-center justify-center overflow-hidden",x.value?"":r(o).isLeader?"bg-primary-500":"bg-primary-500/20"])},[x.value?(i(),c("img",{key:0,src:x.value,alt:"Avatar",class:"w-full h-full object-cover"},null,8,we)):(i(),c("span",{key:1,class:V(["text-5xl font-bold",r(o).isLeader?"text-white":"text-primary-400"])},b(r(o).user?.nick?.charAt(0).toUpperCase()),3))],2),e("button",{onClick:u,disabled:r(s).uploadingAvatar,class:"absolute -bottom-1 -right-1 w-8 h-8 rounded-full bg-primary-500 hover:bg-primary-600 flex items-center justify-center transition-colors disabled:opacity-50",title:"Alterar foto"},[r(s).uploadingAvatar?(i(),C(z,{key:1,class:"w-4 h-4"})):(i(),c("svg",Ce,[...t[6]||(t[6]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"},null,-1),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"},null,-1)])]))],8,_e),x.value&&!r(s).uploadingAvatar?(i(),c("button",{key:0,onClick:k,class:"absolute -bottom-1 -left-1 w-8 h-8 rounded-full bg-red-500 hover:bg-red-600 flex items-center justify-center transition-colors",title:"Remover foto"},[...t[7]||(t[7]=[e("svg",{class:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])])):g("",!0)]),e("div",Ae,[e("h2",Se,b(r(o).user?.nick),1),r(o).isLeader?(i(),c("span",Pe,"ðŸ‘‘")):g("",!0)]),e("p",je,b(r(q)[r(o).user?.playerClass]),1),r(o).isLeader?(i(),c("span",Me," LÃ­der da Guilda ")):g("",!0)])]),r(s).profile?.stats?(i(),c("div",$e,[t[10]||(t[10]=e("h3",{class:"text-lg font-semibold text-gray-100 mb-4"},"EstatÃ­sticas",-1)),e("div",Ee,[e("div",ze,[e("p",Ue,b(r(s).profile.stats.messagesCount),1),t[8]||(t[8]=e("p",{class:"text-sm text-gray-400"},"Mensagens",-1))]),e("div",Be,[e("p",Le,b(r(s).profile.stats.eventsParticipated),1),t[9]||(t[9]=e("p",{class:"text-sm text-gray-400"},"Eventos",-1))])])])):g("",!0),e("div",Ve,[t[14]||(t[14]=e("h3",{class:"text-lg font-semibold text-gray-100 mb-4"},"InformaÃ§Ãµes",-1)),e("div",He,[t[13]||(t[13]=e("div",{class:"flex justify-between items-center py-2 border-b border-dark-600"},[e("span",{class:"text-gray-400"},"Status"),e("span",{class:"text-green-400"},"Ativo")],-1)),e("div",Ne,[t[11]||(t[11]=e("span",{class:"text-gray-400"},"Cargo",-1)),e("span",qe,b(r(o).user?.role===r(W).LEADER?"LÃ­der":"Membro"),1)]),r(s).profile?.createdAt?(i(),c("div",De,[t[12]||(t[12]=e("span",{class:"text-gray-400"},"Membro desde",-1)),e("span",Te,b(_(r(s).profile.createdAt)),1)])):g("",!0)])]),e("div",Ie,[e("button",{onClick:t[0]||(t[0]=v=>f.value=!0),class:"btn-secondary w-full py-3 flex items-center justify-center gap-2"},[...t[15]||(t[15]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1),S(" Editar Perfil ",-1)])]),e("button",{onClick:t[1]||(t[1]=v=>l.value=!0),class:"btn-secondary w-full py-3 flex items-center justify-center gap-2"},[...t[16]||(t[16]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"})],-1),S(" Alterar Senha ",-1)])]),r(o).isLeader?(i(),c($,{key:0},[B(n,{to:"/admin/pending",class:"btn-secondary w-full py-3 flex items-center justify-center gap-2"},{default:U(()=>[...t[17]||(t[17]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})],-1),S(" Membros Pendentes ",-1)])]),_:1}),B(n,{to:"/admin/banned",class:"btn-secondary w-full py-3 flex items-center justify-center gap-2"},{default:U(()=>[...t[18]||(t[18]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636"})],-1),S(" UsuÃ¡rios Banidos ",-1)])]),_:1})],64)):g("",!0),e("button",{onClick:w,class:"btn-ghost w-full py-3 text-red-400 hover:text-red-300 hover:bg-red-500/10 flex items-center justify-center gap-2"},[...t[19]||(t[19]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})],-1),S(" Sair da Conta ",-1)])])])],64))]),r(s).successMessage?(i(),c("div",Re,[e("span",null,b(r(s).successMessage),1),e("button",{onClick:t[2]||(t[2]=v=>r(s).clearSuccessMessage()),class:"ml-4 font-bold"},"OK")])):g("",!0),r(s).error?(i(),c("div",Fe,[e("span",null,b(r(s).error),1),e("button",{onClick:t[3]||(t[3]=v=>r(s).clearError()),class:"ml-4 font-bold"},"OK")])):g("",!0),f.value?(i(),C(ne,{key:2,onClose:t[4]||(t[4]=v=>f.value=!1)})):g("",!0),l.value?(i(),C(ge,{key:3,onClose:t[5]||(t[5]=v=>l.value=!1)})):g("",!0)]),_:1})}}});export{Qe as default};
